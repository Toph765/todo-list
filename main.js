(()=>{"use strict";const t=(()=>{let t=[];return{addToList:function(e){t.push(e),console.log(t)},TodoList:t,removeTask:function(e){return t=t.filter((t=>e!==t.id))}}})(),e=(t,e,n)=>({title:t,taskList:e,id:n}),n=(()=>{let n,o=[],r=t.TodoList;const c=e("General",r,0);o.push(c);let i=0;return{submitProject:function(){document.querySelector("#createProject").addEventListener("click",(t=>{t.preventDefault(),function(){n=document.querySelector("#projectTitle").value;const t=0===o.length?0:o[o.length-1].id+1;if(""!==n){const r=e(n,[],t);console.log(r),function(t){o.push(t),console.log(o)}(r)}}(),""!==n&&(u.displayProject(),document.querySelector("#projectTitle").value="",n="")}))},grabProjectId:function(t){let e=parseInt(t.target.getAttribute("data-projectId"));return i=e,i},grabCurrentProject:function(){return i},grabProjectList:function(){return o},projectList:o,updateGeneralList:function(t){return c.taskList=t,console.log(c.taskList),c},updateProjectList:function(t){let e=c.taskList.filter((e=>e.project===t));return console.log(e),0!==t?o.filter((e=>e.id===t))[0].taskList=e:void 0},grabCurrentProjectTasks:function(t){return console.log(o.filter((e=>e.id===t))[0].taskList),o.filter((e=>e.id===t))[0].taskList}}})();function o(t){const e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new t.constructor(+t):"number"==typeof t||"[object Number]"===e||"string"==typeof t||"[object String]"===e?new Date(t):new Date(NaN)}function r(t){const e=o(t);return e.setHours(0,0,0,0),e}function c(t){return e=t,n=Date.now(),+r(e)==+r(n);var e,n}let i={};function l(){return i}function s(t,e){const n=l(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=o(t),i=c.getDay(),s=(i<r?7:0)+i-r;return c.setDate(c.getDate()-s),c.setHours(0,0,0,0),c}function a(t,e){return function(t,e,n){return+s(t,n)==+s(e,n)}(t,Date.now(),e)}const d=(()=>{function e(e,o){const c=document.createElement("div");c.setAttribute("data-taskId",`${e.id}`),c.classList.add("task");const i=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div"),a=document.createElement("div"),d=document.createElement("button");return i.textContent=`Title: ${e.title}`,l.textContent=`Due Date: ${e.duedate}`,s.textContent=`Description: ${e.description}`,a.textContent=`Priority: ${e.priority}`,d.textContent="delete",d.setAttribute("data-taskId",`${e.id}`),d.addEventListener("click",(()=>function(e,o){let c=t.removeTask(e);const i=document.querySelector("#general");for(n.updateGeneralList(c),n.updateProjectList(o);i.lastElementChild;)i.removeChild(i.lastElementChild);r(o),console.log(n.projectList),console.log(o)}(e.id,e.project))),c.append(i,l,s,a,d),o.appendChild(c),o}function r(t){let e=document.querySelector("#general").getAttribute("class");"inboxTab"===e?i():"todayTab"===e?l():"weekTab"===e?s():e===`project-${t}`&&0!==t&&u.displayProjectTasks(t)}function i(){let t=n.projectList[0].taskList;const o=document.querySelector("#general");for(o.classList.replace(o.getAttribute("class"),"inboxTab");o.lastElementChild;)o.removeChild(o.lastElementChild);t.forEach((t=>e(t,o))),console.log(t)}function l(){let t=n.projectList[0].taskList;const r=document.querySelector("#general");for(r.classList.replace(r.getAttribute("class"),"todayTab");r.lastElementChild;)r.removeChild(r.lastElementChild);t.filter((t=>c(o(t.duedate)))).forEach((t=>e(t,r)))}function s(){let t=n.projectList[0].taskList;const r=document.querySelector("#general");for(r.classList.replace(r.getAttribute("class"),"weekTab");r.lastElementChild;)r.removeChild(r.lastElementChild);t.filter((t=>a(o(t.duedate)))).forEach((t=>e(t,r)))}return{displayNewInput:function(){let t=n.projectList[0].taskList;e(t[t.length-1],document.querySelector("#general"))},displayInbox:i,displayDaily:l,displayWeekly:s,displayAllTask:e,updateDisplay:r}})(),u=(()=>{function t(t){n.projectList;const e=document.querySelector("#general");for(e.classList.replace(e.getAttribute("class"),`project-${t}`);e.lastElementChild;)e.removeChild(e.lastElementChild);n.grabCurrentProjectTasks(t).forEach((t=>d.displayAllTask(t,e)))}return{displayProject:function(){let e=n.projectList,o=e[e.length-1];const r=document.querySelector(".all-projects"),c=document.createElement("div"),i=document.createElement("div"),l=document.createElement("button");return c.classList.add(`project-${o.id}`),c.setAttribute("data-projectId",`${o.id}`),l.setAttribute("data-projectId",`${o.id}`),l.setAttribute("id",`project-${o.id}`),i.textContent=`${o.title}`,l.textContent="+",c.addEventListener("click",(e=>{e.stopPropagation(),t(o.id)})),l.addEventListener("click",(t=>{t.stopPropagation(),console.log("project id",n.grabProjectId(t));const e=document.querySelector("#main-form");n.grabProjectId(t),e.removeAttribute("hidden"),t.preventDefault()})),c.append(i,l),r.appendChild(c),r},displayProjectTasks:t}})(),m=(()=>{let e,r;function i(){const i=n.grabProjectList();e=document.getElementById("title").value,r=document.getElementById("description").value;let l=document.getElementById("date").value,s=document.getElementById("priority").value,d=function(){let t=n.projectList[0].taskList;return 0===t.length?0:t[t.length-1].id+1}(),u=n.grabCurrentProject();if(console.log(a(o(l))),console.log(c(o(l))),""!==e&&""!==r&&""!==l){const n=((t,e,n,o,r,c)=>({id:t,title:e,description:n,duedate:o,priority:r,project:c}))(d,e,r,l,s,u);console.log(n),0===u&&(i[0].taskList.push(n),console.log(i));for(let e=1;e<i.length;e++)i[e].id===u&&(t.addToList(n),i[e].taskList.push(n),console.log(i))}}function l(){document.getElementById("title").value="",e="",document.getElementById("description").value="",r="",document.getElementById("date").value="",document.getElementById("priority").value="Low"}return{createNewTask:i,initSubmitBtn:function(){document.querySelector("#submit").addEventListener("click",(t=>{!function(){const t=document.querySelector("#main-form"),o=document.querySelector("#newTask");if(i(),""!==e&&""!==r){let e=n.projectList[0].taskList,r=e[e.length-1].project;d.updateDisplay(r),l(),t.setAttribute("hidden",""),o.removeAttribute("hidden")}}(),t.preventDefault()}))},cancelTask:function(){const t=document.querySelector("#cancel"),e=document.querySelector("#main-form"),n=document.querySelector("#newTask");t.addEventListener("click",(t=>{l(),e.setAttribute("hidden",""),n.removeAttribute("hidden"),t.preventDefault()}))},openTaskCreator:function(){const t=document.querySelector("#newTask"),e=document.querySelector("#main-form");t.addEventListener("click",(o=>{n.grabProjectId(o),e.removeAttribute("hidden"),t.setAttribute("hidden",""),o.preventDefault()}))}}})();m.initSubmitBtn(),m.cancelTask(),m.openTaskCreator(),n.submitProject();const p=document.querySelector("#today"),f=document.querySelector("#weekly"),y=document.querySelector("#inbox");p.addEventListener("click",d.displayDaily),f.addEventListener("click",d.displayWeekly),y.addEventListener("click",d.displayInbox)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBU0MsY0FBYyxVQUV4Q3NHLEVBQVNyRyxpQkFBaUIsUUFBUXFELEVBQVd1QixjQUM3QzBCLEVBQVF0RyxpQkFBaUIsUUFBU3FELEVBQVd3QixlQUM3QzBCLEVBQVN2RyxpQkFBaUIsUUFBU3FELEVBQVdzQixhIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21hbmFnZUxpc3QuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21hbmFnZVByb2plY3QuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL3RvRGF0ZS5tanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL3N0YXJ0T2ZEYXkubWpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9pc1RvZGF5Lm1qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvaXNTYW1lRGF5Lm1qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvX2xpYi9kZWZhdWx0T3B0aW9ucy5tanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL3N0YXJ0T2ZXZWVrLm1qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvaXNUaGlzV2Vlay5tanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2lzU2FtZVdlZWsubWpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9VSS5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbWFuYWdlVGFzay5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQWRkdG9MaXN0ID0gKCgpID0+IHtcbiAgICBsZXQgVG9kb0xpc3QgPSBbXTtcblxuICAgIGZ1bmN0aW9uIGFkZFRvTGlzdCh0YXNrKSB7XG4gICAgICAgIFRvZG9MaXN0LnB1c2godGFzayk7XG4gICAgICAgIGNvbnNvbGUubG9nKFRvZG9MaXN0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVUYXNrKGlkKSB7XG4gICAgICAgIHJldHVybiBUb2RvTGlzdCA9IFRvZG9MaXN0LmZpbHRlcih0YXNrID0+IGlkICE9PSB0YXNrLmlkKTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBhZGRUb0xpc3QsIFRvZG9MaXN0LCByZW1vdmVUYXNrIH07XG59KSgpXG5cblxuZXhwb3J0IHsgQWRkdG9MaXN0IH0iLCJpbXBvcnQgeyByZW5kZXJQcm9qZWN0IH0gZnJvbSBcIi4vVUlcIjtcbmltcG9ydCB7IEFkZHRvTGlzdCB9IGZyb20gXCIuL21hbmFnZUxpc3RcIjtcbmltcG9ydCB7IE5ld1Rhc2sgfSBmcm9tIFwiLi9tYW5hZ2VUYXNrXCI7XG5cbmNvbnN0IG5ld1Byb2plY3QgPSAodGl0bGUsIHRhc2tMaXN0LCBpZCkgPT4ge1xuICAgIHJldHVybiB7IHRpdGxlLCB0YXNrTGlzdCwgaWQgfTtcbn1cblxuY29uc3QgcHJvamVjdHMgPSAoKCkgPT4ge1xuICAgIGxldCBwcm9qZWN0VGl0bGVcbiAgICBsZXQgcHJvamVjdExpc3QgPSBbXTtcblxuICAgIGxldCB0YXNrTGlzdCA9IEFkZHRvTGlzdC5Ub2RvTGlzdDtcblxuICAgIGNvbnN0IGdlbmVyYWxMaXN0ID0gbmV3UHJvamVjdCgnR2VuZXJhbCcsIHRhc2tMaXN0LCAwKTtcbiAgICBwcm9qZWN0TGlzdC5wdXNoKGdlbmVyYWxMaXN0KTtcblxuICAgIGxldCBjdXJyZW50UHJvamVjdCA9IDA7XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVHZW5lcmFsTGlzdChuZXdMaXN0KSB7XG4gICAgICAgIGdlbmVyYWxMaXN0LnRhc2tMaXN0ID0gbmV3TGlzdFxuICAgICAgICBjb25zb2xlLmxvZyhnZW5lcmFsTGlzdC50YXNrTGlzdClcbiAgICAgICAgcmV0dXJuIGdlbmVyYWxMaXN0XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlUHJvamVjdExpc3QoaWQpIHtcbiAgICAgICAgbGV0IHVwZGF0ZSA9IGdlbmVyYWxMaXN0LnRhc2tMaXN0LmZpbHRlcih0YXNrID0+IHRhc2sucHJvamVjdCA9PT0gaWQpO1xuICAgICAgICBjb25zb2xlLmxvZyh1cGRhdGUpXG4gICAgICAgIGlmIChpZCAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHByb2plY3RMaXN0LmZpbHRlcihwcm9qZWN0ID0+IHByb2plY3QuaWQgPT09IGlkKVswXS50YXNrTGlzdCA9IHVwZGF0ZVxuICAgICAgICB9IGVsc2UgcmV0dXJuO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdyYWJDdXJyZW50UHJvamVjdFRhc2tzKGlkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RMaXN0LmZpbHRlcihwcm9qZWN0ID0+IHByb2plY3QuaWQgPT09IGlkKVswXS50YXNrTGlzdClcbiAgICAgICAgcmV0dXJuIHByb2plY3RMaXN0LmZpbHRlcihwcm9qZWN0ID0+IHByb2plY3QuaWQgPT09IGlkKVswXS50YXNrTGlzdFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdyYWJDdXJyZW50UHJvamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRQcm9qZWN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdyYWJQcm9qZWN0TGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIHByb2plY3RMaXN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QoKSB7XG4gICAgICAgIHByb2plY3RUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0VGl0bGUnKS52YWx1ZTtcbiAgICAgICAgY29uc3QgcHJvamVjdElkID0gY3JlYXRlUHJvamVjdElkKClcbiAgICAgICAgY29uc3QgcHJvamVjdFRhc2tzID0gW107XG5cbiAgICAgICAgaWYgKHByb2plY3RUaXRsZSA9PT0gJycpIHJldHVyblxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3QgPSBuZXdQcm9qZWN0KHByb2plY3RUaXRsZSwgcHJvamVjdFRhc2tzLCBwcm9qZWN0SWQpO1xuICAgICAgICAgICAgY29uc29sZS5sb2cocHJvamVjdCk7XG4gICAgICAgICAgICBhZGRUb1Byb2plY3RMaXN0KHByb2plY3QpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUHJvamVjdElkKCkge1xuICAgICAgICBsZXQgaWQ7XG4gICAgICAgIGlmIChwcm9qZWN0TGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBpZCA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaWQgPSBwcm9qZWN0TGlzdFtwcm9qZWN0TGlzdC5sZW5ndGggLSAxXS5pZCArIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRUb1Byb2plY3RMaXN0KHByb2plY3QpIHtcbiAgICAgICAgcHJvamVjdExpc3QucHVzaChwcm9qZWN0KTtcbiAgICAgICAgY29uc29sZS5sb2cocHJvamVjdExpc3QpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgICBsZXQgcHJvamVjdFRpdGxlVmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdFRpdGxlJyk7XG4gICAgICAgIHByb2plY3RUaXRsZVZhbHVlLnZhbHVlID0gJyc7XG4gICAgICAgIHByb2plY3RUaXRsZSA9ICcnO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFByb2plY3QoKSB7XG4gICAgICAgIGNvbnN0IGNyZWF0ZVByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY3JlYXRlUHJvamVjdCcpO1xuXG4gICAgICAgIGNyZWF0ZVByb2plY3RCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjcmVhdGVQcm9qZWN0KCk7XG4gICAgICAgICAgICBpZiAocHJvamVjdFRpdGxlID09PSAnJykgcmV0dXJuXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZW5kZXJQcm9qZWN0LmRpc3BsYXlQcm9qZWN0KCk7XG4gICAgICAgICAgICAgICAgcmVzZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBncmFiUHJvamVjdElkKGUpIHtcbiAgICAgICAgbGV0IHByb2plY3RJZCA9IHBhcnNlSW50KGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1wcm9qZWN0SWQnKSk7XG5cbiAgICAgICAgY3VycmVudFByb2plY3QgPSBwcm9qZWN0SWQ7XG5cbiAgICAgICAgcmV0dXJuIGN1cnJlbnRQcm9qZWN0O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Ym1pdFByb2plY3QsIGdyYWJQcm9qZWN0SWQsIGdyYWJDdXJyZW50UHJvamVjdCwgZ3JhYlByb2plY3RMaXN0LCBwcm9qZWN0TGlzdCwgdXBkYXRlR2VuZXJhbExpc3QsdXBkYXRlUHJvamVjdExpc3QsIGdyYWJDdXJyZW50UHJvamVjdFRhc2tzIH1cbn0pKClcblxuZXhwb3J0IHsgcHJvamVjdHMgfVxuXG4iLCIvKipcbiAqIEBuYW1lIHRvRGF0ZVxuICogQGNhdGVnb3J5IENvbW1vbiBIZWxwZXJzXG4gKiBAc3VtbWFyeSBDb252ZXJ0IHRoZSBnaXZlbiBhcmd1bWVudCB0byBhbiBpbnN0YW5jZSBvZiBEYXRlLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQ29udmVydCB0aGUgZ2l2ZW4gYXJndW1lbnQgdG8gYW4gaW5zdGFuY2Ugb2YgRGF0ZS5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgYW4gaW5zdGFuY2Ugb2YgRGF0ZSwgdGhlIGZ1bmN0aW9uIHJldHVybnMgaXRzIGNsb25lLlxuICpcbiAqIElmIHRoZSBhcmd1bWVudCBpcyBhIG51bWJlciwgaXQgaXMgdHJlYXRlZCBhcyBhIHRpbWVzdGFtcC5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgbm9uZSBvZiB0aGUgYWJvdmUsIHRoZSBmdW5jdGlvbiByZXR1cm5zIEludmFsaWQgRGF0ZS5cbiAqXG4gKiAqKk5vdGUqKjogKmFsbCogRGF0ZSBhcmd1bWVudHMgcGFzc2VkIHRvIGFueSAqZGF0ZS1mbnMqIGZ1bmN0aW9uIGlzIHByb2Nlc3NlZCBieSBgdG9EYXRlYC5cbiAqXG4gKiBAdHlwZVBhcmFtIERhdGVUeXBlIC0gVGhlIGBEYXRlYCB0eXBlLCB0aGUgZnVuY3Rpb24gb3BlcmF0ZXMgb24uIEdldHMgaW5mZXJyZWQgZnJvbSBwYXNzZWQgYXJndW1lbnRzLiBBbGxvd3MgdG8gdXNlIGV4dGVuc2lvbnMgbGlrZSBbYFVUQ0RhdGVgXShodHRwczovL2dpdGh1Yi5jb20vZGF0ZS1mbnMvdXRjKS5cbiAqXG4gKiBAcGFyYW0gYXJndW1lbnQgLSBUaGUgdmFsdWUgdG8gY29udmVydFxuICpcbiAqIEByZXR1cm5zIFRoZSBwYXJzZWQgZGF0ZSBpbiB0aGUgbG9jYWwgdGltZSB6b25lXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIENsb25lIHRoZSBkYXRlOlxuICogY29uc3QgcmVzdWx0ID0gdG9EYXRlKG5ldyBEYXRlKDIwMTQsIDEsIDExLCAxMSwgMzAsIDMwKSlcbiAqIC8vPT4gVHVlIEZlYiAxMSAyMDE0IDExOjMwOjMwXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIENvbnZlcnQgdGhlIHRpbWVzdGFtcCB0byBkYXRlOlxuICogY29uc3QgcmVzdWx0ID0gdG9EYXRlKDEzOTIwOTg0MzAwMDApXG4gKiAvLz0+IFR1ZSBGZWIgMTEgMjAxNCAxMTozMDozMFxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9EYXRlKGFyZ3VtZW50KSB7XG4gIGNvbnN0IGFyZ1N0ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmd1bWVudCk7XG5cbiAgLy8gQ2xvbmUgdGhlIGRhdGVcbiAgaWYgKFxuICAgIGFyZ3VtZW50IGluc3RhbmNlb2YgRGF0ZSB8fFxuICAgICh0eXBlb2YgYXJndW1lbnQgPT09IFwib2JqZWN0XCIgJiYgYXJnU3RyID09PSBcIltvYmplY3QgRGF0ZV1cIilcbiAgKSB7XG4gICAgLy8gUHJldmVudCB0aGUgZGF0ZSB0byBsb3NlIHRoZSBtaWxsaXNlY29uZHMgd2hlbiBwYXNzZWQgdG8gbmV3IERhdGUoKSBpbiBJRTEwXG4gICAgcmV0dXJuIG5ldyBhcmd1bWVudC5jb25zdHJ1Y3RvcigrYXJndW1lbnQpO1xuICB9IGVsc2UgaWYgKFxuICAgIHR5cGVvZiBhcmd1bWVudCA9PT0gXCJudW1iZXJcIiB8fFxuICAgIGFyZ1N0ciA9PT0gXCJbb2JqZWN0IE51bWJlcl1cIiB8fFxuICAgIHR5cGVvZiBhcmd1bWVudCA9PT0gXCJzdHJpbmdcIiB8fFxuICAgIGFyZ1N0ciA9PT0gXCJbb2JqZWN0IFN0cmluZ11cIlxuICApIHtcbiAgICAvLyBUT0RPOiBDYW4gd2UgZ2V0IHJpZCBvZiBhcz9cbiAgICByZXR1cm4gbmV3IERhdGUoYXJndW1lbnQpO1xuICB9IGVsc2Uge1xuICAgIC8vIFRPRE86IENhbiB3ZSBnZXQgcmlkIG9mIGFzP1xuICAgIHJldHVybiBuZXcgRGF0ZShOYU4pO1xuICB9XG59XG5cbi8vIEZhbGxiYWNrIGZvciBtb2R1bGFyaXplZCBpbXBvcnRzOlxuZXhwb3J0IGRlZmF1bHQgdG9EYXRlO1xuIiwiaW1wb3J0IHsgdG9EYXRlIH0gZnJvbSBcIi4vdG9EYXRlLm1qc1wiO1xuXG4vKipcbiAqIEBuYW1lIHN0YXJ0T2ZEYXlcbiAqIEBjYXRlZ29yeSBEYXkgSGVscGVyc1xuICogQHN1bW1hcnkgUmV0dXJuIHRoZSBzdGFydCBvZiBhIGRheSBmb3IgdGhlIGdpdmVuIGRhdGUuXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBSZXR1cm4gdGhlIHN0YXJ0IG9mIGEgZGF5IGZvciB0aGUgZ2l2ZW4gZGF0ZS5cbiAqIFRoZSByZXN1bHQgd2lsbCBiZSBpbiB0aGUgbG9jYWwgdGltZXpvbmUuXG4gKlxuICogQHR5cGVQYXJhbSBEYXRlVHlwZSAtIFRoZSBgRGF0ZWAgdHlwZSwgdGhlIGZ1bmN0aW9uIG9wZXJhdGVzIG9uLiBHZXRzIGluZmVycmVkIGZyb20gcGFzc2VkIGFyZ3VtZW50cy4gQWxsb3dzIHRvIHVzZSBleHRlbnNpb25zIGxpa2UgW2BVVENEYXRlYF0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL3V0YykuXG4gKlxuICogQHBhcmFtIGRhdGUgLSBUaGUgb3JpZ2luYWwgZGF0ZVxuICpcbiAqIEByZXR1cm5zIFRoZSBzdGFydCBvZiBhIGRheVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBUaGUgc3RhcnQgb2YgYSBkYXkgZm9yIDIgU2VwdGVtYmVyIDIwMTQgMTE6NTU6MDA6XG4gKiBjb25zdCByZXN1bHQgPSBzdGFydE9mRGF5KG5ldyBEYXRlKDIwMTQsIDgsIDIsIDExLCA1NSwgMCkpXG4gKiAvLz0+IFR1ZSBTZXAgMDIgMjAxNCAwMDowMDowMFxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRPZkRheShkYXRlKSB7XG4gIGNvbnN0IF9kYXRlID0gdG9EYXRlKGRhdGUpO1xuICBfZGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgcmV0dXJuIF9kYXRlO1xufVxuXG4vLyBGYWxsYmFjayBmb3IgbW9kdWxhcml6ZWQgaW1wb3J0czpcbmV4cG9ydCBkZWZhdWx0IHN0YXJ0T2ZEYXk7XG4iLCJpbXBvcnQgeyBpc1NhbWVEYXkgfSBmcm9tIFwiLi9pc1NhbWVEYXkubWpzXCI7XG5cbi8qKlxuICogQG5hbWUgaXNUb2RheVxuICogQGNhdGVnb3J5IERheSBIZWxwZXJzXG4gKiBAc3VtbWFyeSBJcyB0aGUgZ2l2ZW4gZGF0ZSB0b2RheT9cbiAqIEBwdXJlIGZhbHNlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBJcyB0aGUgZ2l2ZW4gZGF0ZSB0b2RheT9cbiAqXG4gKiBAdHlwZVBhcmFtIERhdGVUeXBlIC0gVGhlIGBEYXRlYCB0eXBlLCB0aGUgZnVuY3Rpb24gb3BlcmF0ZXMgb24uIEdldHMgaW5mZXJyZWQgZnJvbSBwYXNzZWQgYXJndW1lbnRzLiBBbGxvd3MgdG8gdXNlIGV4dGVuc2lvbnMgbGlrZSBbYFVUQ0RhdGVgXShodHRwczovL2dpdGh1Yi5jb20vZGF0ZS1mbnMvdXRjKS5cbiAqXG4gKiBAcGFyYW0gZGF0ZSAtIFRoZSBkYXRlIHRvIGNoZWNrXG4gKlxuICogQHJldHVybnMgVGhlIGRhdGUgaXMgdG9kYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gSWYgdG9kYXkgaXMgNiBPY3RvYmVyIDIwMTQsIGlzIDYgT2N0b2JlciAxNDowMDowMCB0b2RheT9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzVG9kYXkobmV3IERhdGUoMjAxNCwgOSwgNiwgMTQsIDApKVxuICogLy89PiB0cnVlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RvZGF5KGRhdGUpIHtcbiAgcmV0dXJuIGlzU2FtZURheShkYXRlLCBEYXRlLm5vdygpKTtcbn1cblxuLy8gRmFsbGJhY2sgZm9yIG1vZHVsYXJpemVkIGltcG9ydHM6XG5leHBvcnQgZGVmYXVsdCBpc1RvZGF5O1xuIiwiaW1wb3J0IHsgc3RhcnRPZkRheSB9IGZyb20gXCIuL3N0YXJ0T2ZEYXkubWpzXCI7XG5cbi8qKlxuICogQG5hbWUgaXNTYW1lRGF5XG4gKiBAY2F0ZWdvcnkgRGF5IEhlbHBlcnNcbiAqIEBzdW1tYXJ5IEFyZSB0aGUgZ2l2ZW4gZGF0ZXMgaW4gdGhlIHNhbWUgZGF5IChhbmQgeWVhciBhbmQgbW9udGgpP1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQXJlIHRoZSBnaXZlbiBkYXRlcyBpbiB0aGUgc2FtZSBkYXkgKGFuZCB5ZWFyIGFuZCBtb250aCk/XG4gKlxuICogQHR5cGVQYXJhbSBEYXRlVHlwZSAtIFRoZSBgRGF0ZWAgdHlwZSwgdGhlIGZ1bmN0aW9uIG9wZXJhdGVzIG9uLiBHZXRzIGluZmVycmVkIGZyb20gcGFzc2VkIGFyZ3VtZW50cy4gQWxsb3dzIHRvIHVzZSBleHRlbnNpb25zIGxpa2UgW2BVVENEYXRlYF0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL3V0YykuXG4gKlxuICogQHBhcmFtIGRhdGVMZWZ0IC0gVGhlIGZpcnN0IGRhdGUgdG8gY2hlY2tcbiAqIEBwYXJhbSBkYXRlUmlnaHQgLSBUaGUgc2Vjb25kIGRhdGUgdG8gY2hlY2tcblxuICogQHJldHVybnMgVGhlIGRhdGVzIGFyZSBpbiB0aGUgc2FtZSBkYXkgKGFuZCB5ZWFyIGFuZCBtb250aClcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQXJlIDQgU2VwdGVtYmVyIDA2OjAwOjAwIGFuZCA0IFNlcHRlbWJlciAxODowMDowMCBpbiB0aGUgc2FtZSBkYXk/XG4gKiBjb25zdCByZXN1bHQgPSBpc1NhbWVEYXkobmV3IERhdGUoMjAxNCwgOCwgNCwgNiwgMCksIG5ldyBEYXRlKDIwMTQsIDgsIDQsIDE4LCAwKSlcbiAqIC8vPT4gdHJ1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBcmUgNCBTZXB0ZW1iZXIgYW5kIDQgT2N0b2JlciBpbiB0aGUgc2FtZSBkYXk/XG4gKiBjb25zdCByZXN1bHQgPSBpc1NhbWVEYXkobmV3IERhdGUoMjAxNCwgOCwgNCksIG5ldyBEYXRlKDIwMTQsIDksIDQpKVxuICogLy89PiBmYWxzZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBcmUgNCBTZXB0ZW1iZXIsIDIwMTQgYW5kIDQgU2VwdGVtYmVyLCAyMDE1IGluIHRoZSBzYW1lIGRheT9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzU2FtZURheShuZXcgRGF0ZSgyMDE0LCA4LCA0KSwgbmV3IERhdGUoMjAxNSwgOCwgNCkpXG4gKiAvLz0+IGZhbHNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1NhbWVEYXkoZGF0ZUxlZnQsIGRhdGVSaWdodCkge1xuICBjb25zdCBkYXRlTGVmdFN0YXJ0T2ZEYXkgPSBzdGFydE9mRGF5KGRhdGVMZWZ0KTtcbiAgY29uc3QgZGF0ZVJpZ2h0U3RhcnRPZkRheSA9IHN0YXJ0T2ZEYXkoZGF0ZVJpZ2h0KTtcblxuICByZXR1cm4gK2RhdGVMZWZ0U3RhcnRPZkRheSA9PT0gK2RhdGVSaWdodFN0YXJ0T2ZEYXk7XG59XG5cbi8vIEZhbGxiYWNrIGZvciBtb2R1bGFyaXplZCBpbXBvcnRzOlxuZXhwb3J0IGRlZmF1bHQgaXNTYW1lRGF5O1xuIiwibGV0IGRlZmF1bHRPcHRpb25zID0ge307XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0T3B0aW9ucygpIHtcbiAgcmV0dXJuIGRlZmF1bHRPcHRpb25zO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0RGVmYXVsdE9wdGlvbnMobmV3T3B0aW9ucykge1xuICBkZWZhdWx0T3B0aW9ucyA9IG5ld09wdGlvbnM7XG59XG4iLCJpbXBvcnQgeyB0b0RhdGUgfSBmcm9tIFwiLi90b0RhdGUubWpzXCI7XG5pbXBvcnQgeyBnZXREZWZhdWx0T3B0aW9ucyB9IGZyb20gXCIuL19saWIvZGVmYXVsdE9wdGlvbnMubWpzXCI7XG5cbi8qKlxuICogVGhlIHtAbGluayBzdGFydE9mV2Vla30gZnVuY3Rpb24gb3B0aW9ucy5cbiAqL1xuXG4vKipcbiAqIEBuYW1lIHN0YXJ0T2ZXZWVrXG4gKiBAY2F0ZWdvcnkgV2VlayBIZWxwZXJzXG4gKiBAc3VtbWFyeSBSZXR1cm4gdGhlIHN0YXJ0IG9mIGEgd2VlayBmb3IgdGhlIGdpdmVuIGRhdGUuXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBSZXR1cm4gdGhlIHN0YXJ0IG9mIGEgd2VlayBmb3IgdGhlIGdpdmVuIGRhdGUuXG4gKiBUaGUgcmVzdWx0IHdpbGwgYmUgaW4gdGhlIGxvY2FsIHRpbWV6b25lLlxuICpcbiAqIEB0eXBlUGFyYW0gRGF0ZVR5cGUgLSBUaGUgYERhdGVgIHR5cGUsIHRoZSBmdW5jdGlvbiBvcGVyYXRlcyBvbi4gR2V0cyBpbmZlcnJlZCBmcm9tIHBhc3NlZCBhcmd1bWVudHMuIEFsbG93cyB0byB1c2UgZXh0ZW5zaW9ucyBsaWtlIFtgVVRDRGF0ZWBdKGh0dHBzOi8vZ2l0aHViLmNvbS9kYXRlLWZucy91dGMpLlxuICpcbiAqIEBwYXJhbSBkYXRlIC0gVGhlIG9yaWdpbmFsIGRhdGVcbiAqIEBwYXJhbSBvcHRpb25zIC0gQW4gb2JqZWN0IHdpdGggb3B0aW9uc1xuICpcbiAqIEByZXR1cm5zIFRoZSBzdGFydCBvZiBhIHdlZWtcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gVGhlIHN0YXJ0IG9mIGEgd2VlayBmb3IgMiBTZXB0ZW1iZXIgMjAxNCAxMTo1NTowMDpcbiAqIGNvbnN0IHJlc3VsdCA9IHN0YXJ0T2ZXZWVrKG5ldyBEYXRlKDIwMTQsIDgsIDIsIDExLCA1NSwgMCkpXG4gKiAvLz0+IFN1biBBdWcgMzEgMjAxNCAwMDowMDowMFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJZiB0aGUgd2VlayBzdGFydHMgb24gTW9uZGF5LCB0aGUgc3RhcnQgb2YgdGhlIHdlZWsgZm9yIDIgU2VwdGVtYmVyIDIwMTQgMTE6NTU6MDA6XG4gKiBjb25zdCByZXN1bHQgPSBzdGFydE9mV2VlayhuZXcgRGF0ZSgyMDE0LCA4LCAyLCAxMSwgNTUsIDApLCB7IHdlZWtTdGFydHNPbjogMSB9KVxuICogLy89PiBNb24gU2VwIDAxIDIwMTQgMDA6MDA6MDBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0T2ZXZWVrKGRhdGUsIG9wdGlvbnMpIHtcbiAgY29uc3QgZGVmYXVsdE9wdGlvbnMgPSBnZXREZWZhdWx0T3B0aW9ucygpO1xuICBjb25zdCB3ZWVrU3RhcnRzT24gPVxuICAgIG9wdGlvbnM/LndlZWtTdGFydHNPbiA/P1xuICAgIG9wdGlvbnM/LmxvY2FsZT8ub3B0aW9ucz8ud2Vla1N0YXJ0c09uID8/XG4gICAgZGVmYXVsdE9wdGlvbnMud2Vla1N0YXJ0c09uID8/XG4gICAgZGVmYXVsdE9wdGlvbnMubG9jYWxlPy5vcHRpb25zPy53ZWVrU3RhcnRzT24gPz9cbiAgICAwO1xuXG4gIGNvbnN0IF9kYXRlID0gdG9EYXRlKGRhdGUpO1xuICBjb25zdCBkYXkgPSBfZGF0ZS5nZXREYXkoKTtcbiAgY29uc3QgZGlmZiA9IChkYXkgPCB3ZWVrU3RhcnRzT24gPyA3IDogMCkgKyBkYXkgLSB3ZWVrU3RhcnRzT247XG5cbiAgX2RhdGUuc2V0RGF0ZShfZGF0ZS5nZXREYXRlKCkgLSBkaWZmKTtcbiAgX2RhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gIHJldHVybiBfZGF0ZTtcbn1cblxuLy8gRmFsbGJhY2sgZm9yIG1vZHVsYXJpemVkIGltcG9ydHM6XG5leHBvcnQgZGVmYXVsdCBzdGFydE9mV2VlaztcbiIsImltcG9ydCB7IGlzU2FtZVdlZWsgfSBmcm9tIFwiLi9pc1NhbWVXZWVrLm1qc1wiO1xuXG4vKipcbiAqIFRoZSB7QGxpbmsgaXNUaGlzV2Vla30gZnVuY3Rpb24gb3B0aW9ucy5cbiAqL1xuXG4vKipcbiAqIEBuYW1lIGlzVGhpc1dlZWtcbiAqIEBjYXRlZ29yeSBXZWVrIEhlbHBlcnNcbiAqIEBzdW1tYXJ5IElzIHRoZSBnaXZlbiBkYXRlIGluIHRoZSBzYW1lIHdlZWsgYXMgdGhlIGN1cnJlbnQgZGF0ZT9cbiAqIEBwdXJlIGZhbHNlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBJcyB0aGUgZ2l2ZW4gZGF0ZSBpbiB0aGUgc2FtZSB3ZWVrIGFzIHRoZSBjdXJyZW50IGRhdGU/XG4gKlxuICogQHR5cGVQYXJhbSBEYXRlVHlwZSAtIFRoZSBgRGF0ZWAgdHlwZSwgdGhlIGZ1bmN0aW9uIG9wZXJhdGVzIG9uLiBHZXRzIGluZmVycmVkIGZyb20gcGFzc2VkIGFyZ3VtZW50cy4gQWxsb3dzIHRvIHVzZSBleHRlbnNpb25zIGxpa2UgW2BVVENEYXRlYF0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL3V0YykuXG4gKlxuICogQHBhcmFtIGRhdGUgLSBUaGUgZGF0ZSB0byBjaGVja1xuICogQHBhcmFtIG9wdGlvbnMgLSBUaGUgb2JqZWN0IHdpdGggb3B0aW9uc1xuICpcbiAqIEByZXR1cm5zIFRoZSBkYXRlIGlzIGluIHRoaXMgd2Vla1xuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJZiB0b2RheSBpcyAyNSBTZXB0ZW1iZXIgMjAxNCwgaXMgMjEgU2VwdGVtYmVyIDIwMTQgaW4gdGhpcyB3ZWVrP1xuICogY29uc3QgcmVzdWx0ID0gaXNUaGlzV2VlayhuZXcgRGF0ZSgyMDE0LCA4LCAyMSkpXG4gKiAvLz0+IHRydWVcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gSWYgdG9kYXkgaXMgMjUgU2VwdGVtYmVyIDIwMTQgYW5kIHdlZWsgc3RhcnRzIHdpdGggTW9uZGF5XG4gKiAvLyBpcyAyMSBTZXB0ZW1iZXIgMjAxNCBpbiB0aGlzIHdlZWs/XG4gKiBjb25zdCByZXN1bHQgPSBpc1RoaXNXZWVrKG5ldyBEYXRlKDIwMTQsIDgsIDIxKSwgeyB3ZWVrU3RhcnRzT246IDEgfSlcbiAqIC8vPT4gZmFsc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVGhpc1dlZWsoZGF0ZSwgb3B0aW9ucykge1xuICByZXR1cm4gaXNTYW1lV2VlayhkYXRlLCBEYXRlLm5vdygpLCBvcHRpb25zKTtcbn1cblxuLy8gRmFsbGJhY2sgZm9yIG1vZHVsYXJpemVkIGltcG9ydHM6XG5leHBvcnQgZGVmYXVsdCBpc1RoaXNXZWVrO1xuIiwiaW1wb3J0IHsgc3RhcnRPZldlZWsgfSBmcm9tIFwiLi9zdGFydE9mV2Vlay5tanNcIjtcblxuLyoqXG4gKiBUaGUge0BsaW5rIGlzU2FtZVdlZWt9IGZ1bmN0aW9uIG9wdGlvbnMuXG4gKi9cblxuLyoqXG4gKiBAbmFtZSBpc1NhbWVXZWVrXG4gKiBAY2F0ZWdvcnkgV2VlayBIZWxwZXJzXG4gKiBAc3VtbWFyeSBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIHdlZWsgKGFuZCBtb250aCBhbmQgeWVhcik/XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIHdlZWsgKGFuZCBtb250aCBhbmQgeWVhcik/XG4gKlxuICogQHR5cGVQYXJhbSBEYXRlVHlwZSAtIFRoZSBgRGF0ZWAgdHlwZSwgdGhlIGZ1bmN0aW9uIG9wZXJhdGVzIG9uLiBHZXRzIGluZmVycmVkIGZyb20gcGFzc2VkIGFyZ3VtZW50cy4gQWxsb3dzIHRvIHVzZSBleHRlbnNpb25zIGxpa2UgW2BVVENEYXRlYF0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL3V0YykuXG4gKlxuICogQHBhcmFtIGRhdGVMZWZ0IC0gVGhlIGZpcnN0IGRhdGUgdG8gY2hlY2tcbiAqIEBwYXJhbSBkYXRlUmlnaHQgLSBUaGUgc2Vjb25kIGRhdGUgdG8gY2hlY2tcbiAqIEBwYXJhbSBvcHRpb25zIC0gQW4gb2JqZWN0IHdpdGggb3B0aW9uc1xuICpcbiAqIEByZXR1cm5zIFRoZSBkYXRlcyBhcmUgaW4gdGhlIHNhbWUgd2VlayAoYW5kIG1vbnRoIGFuZCB5ZWFyKVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBcmUgMzEgQXVndXN0IDIwMTQgYW5kIDQgU2VwdGVtYmVyIDIwMTQgaW4gdGhlIHNhbWUgd2Vlaz9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzU2FtZVdlZWsobmV3IERhdGUoMjAxNCwgNywgMzEpLCBuZXcgRGF0ZSgyMDE0LCA4LCA0KSlcbiAqIC8vPT4gdHJ1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJZiB3ZWVrIHN0YXJ0cyB3aXRoIE1vbmRheSxcbiAqIC8vIGFyZSAzMSBBdWd1c3QgMjAxNCBhbmQgNCBTZXB0ZW1iZXIgMjAxNCBpbiB0aGUgc2FtZSB3ZWVrP1xuICogY29uc3QgcmVzdWx0ID0gaXNTYW1lV2VlayhuZXcgRGF0ZSgyMDE0LCA3LCAzMSksIG5ldyBEYXRlKDIwMTQsIDgsIDQpLCB7XG4gKiAgIHdlZWtTdGFydHNPbjogMVxuICogfSlcbiAqIC8vPT4gZmFsc2VcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQXJlIDEgSmFudWFyeSAyMDE0IGFuZCAxIEphbnVhcnkgMjAxNSBpbiB0aGUgc2FtZSB3ZWVrP1xuICogY29uc3QgcmVzdWx0ID0gaXNTYW1lV2VlayhuZXcgRGF0ZSgyMDE0LCAwLCAxKSwgbmV3IERhdGUoMjAxNSwgMCwgMSkpXG4gKiAvLz0+IGZhbHNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1NhbWVXZWVrKGRhdGVMZWZ0LCBkYXRlUmlnaHQsIG9wdGlvbnMpIHtcbiAgY29uc3QgZGF0ZUxlZnRTdGFydE9mV2VlayA9IHN0YXJ0T2ZXZWVrKGRhdGVMZWZ0LCBvcHRpb25zKTtcbiAgY29uc3QgZGF0ZVJpZ2h0U3RhcnRPZldlZWsgPSBzdGFydE9mV2VlayhkYXRlUmlnaHQsIG9wdGlvbnMpO1xuXG4gIHJldHVybiArZGF0ZUxlZnRTdGFydE9mV2VlayA9PT0gK2RhdGVSaWdodFN0YXJ0T2ZXZWVrO1xufVxuXG4vLyBGYWxsYmFjayBmb3IgbW9kdWxhcml6ZWQgaW1wb3J0czpcbmV4cG9ydCBkZWZhdWx0IGlzU2FtZVdlZWs7XG4iLCJpbXBvcnQgeyBwcm9qZWN0cyB9IGZyb20gXCIuL21hbmFnZVByb2plY3RcIjtcbmltcG9ydCB7IGlzVG9kYXksIHRvRGF0ZSwgaXNUaGlzV2VlayB9IGZyb20gXCJkYXRlLWZuc1wiO1xuaW1wb3J0IHsgQWRkdG9MaXN0IH0gZnJvbSBcIi4vbWFuYWdlTGlzdFwiO1xuXG5jb25zdCByZW5kZXJUYXNrID0gKCgpID0+IHtcbiAgICBmdW5jdGlvbiBkaXNwbGF5QWxsVGFzayhpdGVtcywgZGlzcGxheSkge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXRhc2tJZCcsIGAke2l0ZW1zLmlkfWApXG5cbiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3Rhc2snKTtcblxuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICAgIGNvbnN0IGR1ZWRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29uc3QgcHJpb3JpdHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgICAgICAgdGl0bGUudGV4dENvbnRlbnQgPSBgVGl0bGU6ICR7aXRlbXMudGl0bGV9YDtcbiAgICAgICAgZHVlZGF0ZS50ZXh0Q29udGVudCA9IGBEdWUgRGF0ZTogJHtpdGVtcy5kdWVkYXRlfWA7XG4gICAgICAgIGRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gYERlc2NyaXB0aW9uOiAke2l0ZW1zLmRlc2NyaXB0aW9ufWA7XG4gICAgICAgIHByaW9yaXR5LnRleHRDb250ZW50ID0gYFByaW9yaXR5OiAke2l0ZW1zLnByaW9yaXR5fWA7XG4gICAgICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9ICdkZWxldGUnO1xuXG4gICAgICAgIGRlbGV0ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGFza0lkJywgYCR7aXRlbXMuaWR9YCk7XG5cbiAgICAgICAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gaW5pdERlbEJ0bihpdGVtcy5pZCwgaXRlbXMucHJvamVjdCkpO1xuXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmQodGl0bGUsIGR1ZWRhdGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZGVsZXRlQnRuKTtcbiAgICAgICAgZGlzcGxheS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuXG4gICAgICAgIHJldHVybiBkaXNwbGF5O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXREZWxCdG4oaWQsIHByb2plY3RJZCkge1xuICAgICAgICBsZXQgQWxsdGFzayA9IEFkZHRvTGlzdC5yZW1vdmVUYXNrKGlkKTtcbiAgICAgICAgY29uc3QgZ2VuZXJhbExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZ2VuZXJhbCcpO1xuXG4gICAgICAgIHByb2plY3RzLnVwZGF0ZUdlbmVyYWxMaXN0KEFsbHRhc2spO1xuICAgICAgICBwcm9qZWN0cy51cGRhdGVQcm9qZWN0TGlzdChwcm9qZWN0SWQpO1xuXG4gICAgICAgIHdoaWxlIChnZW5lcmFsTGlzdC5sYXN0RWxlbWVudENoaWxkKSBnZW5lcmFsTGlzdC5yZW1vdmVDaGlsZChnZW5lcmFsTGlzdC5sYXN0RWxlbWVudENoaWxkKTtcbiAgICAgICAgXG4gICAgICAgIHVwZGF0ZURpc3BsYXkocHJvamVjdElkKTtcblxuICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0cy5wcm9qZWN0TGlzdCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RJZClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBncmFiVGFiKCkge1xuICAgICAgICBsZXQgY3VycmVudFRhYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnZW5lcmFsJykuZ2V0QXR0cmlidXRlKCdjbGFzcycpO1xuICAgICAgICByZXR1cm4gY3VycmVudFRhYjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVEaXNwbGF5KGlkKSB7XG4gICAgICAgIGxldCB0YWIgPSBncmFiVGFiKCk7XG4gICAgICAgIGlmICh0YWIgPT09ICdpbmJveFRhYicpIGRpc3BsYXlJbmJveCgpXG4gICAgICAgIGVsc2UgaWYgKHRhYiA9PT0gJ3RvZGF5VGFiJykgZGlzcGxheURhaWx5KClcbiAgICAgICAgZWxzZSBpZiAodGFiID09PSAnd2Vla1RhYicpIGRpc3BsYXlXZWVrbHkoKVxuICAgICAgICBlbHNlIGlmICh0YWIgPT09IGBwcm9qZWN0LSR7aWR9YCAmJiBpZCAhPT0gMCkgcmVuZGVyUHJvamVjdC5kaXNwbGF5UHJvamVjdFRhc2tzKGlkKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3BsYXlOZXdJbnB1dCgpIHtcbiAgICAgICAgbGV0IGxpc3QgPSBwcm9qZWN0cy5wcm9qZWN0TGlzdFswXS50YXNrTGlzdDtcbiAgICAgICAgbGV0IGl0ZW1zID0gbGlzdFtsaXN0Lmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGNvbnN0IGdlbmVyYWxMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2dlbmVyYWwnKTtcbiAgICAgICAgXG4gICAgICAgIGRpc3BsYXlBbGxUYXNrKGl0ZW1zLCBnZW5lcmFsTGlzdCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlzcGxheUluYm94KCkge1xuICAgICAgICBsZXQgbGlzdCA9IHByb2plY3RzLnByb2plY3RMaXN0WzBdLnRhc2tMaXN0O1xuICAgICAgICBjb25zdCBnZW5lcmFsTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnZW5lcmFsJyk7XG4gICAgICAgIGdlbmVyYWxMaXN0LmNsYXNzTGlzdC5yZXBsYWNlKGdlbmVyYWxMaXN0LmdldEF0dHJpYnV0ZSgnY2xhc3MnKSwgJ2luYm94VGFiJyk7XG5cbiAgICAgICAgd2hpbGUgKGdlbmVyYWxMaXN0Lmxhc3RFbGVtZW50Q2hpbGQpIGdlbmVyYWxMaXN0LnJlbW92ZUNoaWxkKGdlbmVyYWxMaXN0Lmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gICAgICAgIGxpc3QuZm9yRWFjaCh0YXNrID0+IGRpc3BsYXlBbGxUYXNrKHRhc2ssIGdlbmVyYWxMaXN0KSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGxpc3QpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlzcGxheURhaWx5KCkge1xuICAgICAgICBsZXQgbGlzdCA9IHByb2plY3RzLnByb2plY3RMaXN0WzBdLnRhc2tMaXN0O1xuICAgICAgICBjb25zdCBnZW5lcmFsTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnZW5lcmFsJyk7XG4gICAgICAgIGdlbmVyYWxMaXN0LmNsYXNzTGlzdC5yZXBsYWNlKGdlbmVyYWxMaXN0LmdldEF0dHJpYnV0ZSgnY2xhc3MnKSwgJ3RvZGF5VGFiJyk7XG5cbiAgICAgICAgd2hpbGUgKGdlbmVyYWxMaXN0Lmxhc3RFbGVtZW50Q2hpbGQpIGdlbmVyYWxMaXN0LnJlbW92ZUNoaWxkKGdlbmVyYWxMaXN0Lmxhc3RFbGVtZW50Q2hpbGQpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZGFpbHlUYXNrcyA9IGxpc3QuZmlsdGVyKHRhc2sgPT4gaXNUb2RheSh0b0RhdGUodGFzay5kdWVkYXRlKSkpO1xuICAgICAgICBcbiAgICAgICAgZGFpbHlUYXNrcy5mb3JFYWNoKHRhc2sgPT4gZGlzcGxheUFsbFRhc2sodGFzaywgZ2VuZXJhbExpc3QpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNwbGF5V2Vla2x5KCkge1xuICAgICAgICBsZXQgbGlzdCA9IHByb2plY3RzLnByb2plY3RMaXN0WzBdLnRhc2tMaXN0O1xuICAgICAgICBjb25zdCBnZW5lcmFsTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnZW5lcmFsJyk7XG4gICAgICAgIGdlbmVyYWxMaXN0LmNsYXNzTGlzdC5yZXBsYWNlKGdlbmVyYWxMaXN0LmdldEF0dHJpYnV0ZSgnY2xhc3MnKSwgJ3dlZWtUYWInKTtcblxuICAgICAgICB3aGlsZSAoZ2VuZXJhbExpc3QubGFzdEVsZW1lbnRDaGlsZCkgZ2VuZXJhbExpc3QucmVtb3ZlQ2hpbGQoZ2VuZXJhbExpc3QubGFzdEVsZW1lbnRDaGlsZCk7XG5cbiAgICAgICAgY29uc3Qgd2Vla2x5VGFza3MgPSBsaXN0LmZpbHRlcih0YXNrID0+IGlzVGhpc1dlZWsodG9EYXRlKHRhc2suZHVlZGF0ZSkpKTtcblxuICAgICAgICB3ZWVrbHlUYXNrcy5mb3JFYWNoKHRhc2sgPT4gZGlzcGxheUFsbFRhc2sodGFzaywgZ2VuZXJhbExpc3QpKTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBkaXNwbGF5TmV3SW5wdXQsIGRpc3BsYXlJbmJveCwgZGlzcGxheURhaWx5LCBkaXNwbGF5V2Vla2x5LCBkaXNwbGF5QWxsVGFzaywgdXBkYXRlRGlzcGxheSB9XG59KSgpXG5cbmNvbnN0IHJlbmRlclByb2plY3QgPSAoKCkgPT4ge1xuICAgIGZ1bmN0aW9uIGRpc3BsYXlQcm9qZWN0KCkge1xuICAgICAgICBsZXQgbGlzdCA9IHByb2plY3RzLnByb2plY3RMaXN0O1xuICAgICAgICBsZXQgcHJvamVjdCA9IGxpc3RbbGlzdC5sZW5ndGggLSAxXTtcblxuICAgICAgICBjb25zdCBwcm9qZWN0RGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hbGwtcHJvamVjdHMnKTtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cbiAgICAgICAgY29uc3QgcHJvamVjdFRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGNvbnN0IHByb2plY3RUYXNrQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoYHByb2plY3QtJHtwcm9qZWN0LmlkfWApO1xuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXByb2plY3RJZCcsIGAke3Byb2plY3QuaWR9YCk7XG4gICAgICAgIHByb2plY3RUYXNrQnRuLnNldEF0dHJpYnV0ZSgnZGF0YS1wcm9qZWN0SWQnLCBgJHtwcm9qZWN0LmlkfWApO1xuICAgICAgICBwcm9qZWN0VGFza0J0bi5zZXRBdHRyaWJ1dGUoJ2lkJywgYHByb2plY3QtJHtwcm9qZWN0LmlkfWApO1xuXG4gICAgICAgIHByb2plY3RUaXRsZS50ZXh0Q29udGVudCA9IGAke3Byb2plY3QudGl0bGV9YDtcbiAgICAgICAgcHJvamVjdFRhc2tCdG4udGV4dENvbnRlbnQgPSAnKyc7XG5cbiAgICAgICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBkaXNwbGF5UHJvamVjdFRhc2tzKHByb2plY3QuaWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBwcm9qZWN0VGFza0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Byb2plY3QgaWQnLCBwcm9qZWN0cy5ncmFiUHJvamVjdElkKGUpKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1Rhc2tGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21haW4tZm9ybScpO1xuXG4gICAgICAgICAgICBwcm9qZWN0cy5ncmFiUHJvamVjdElkKGUpO1xuICAgICAgICAgICAgbmV3VGFza0Zvcm0ucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjb250YWluZXIuYXBwZW5kKHByb2plY3RUaXRsZSwgcHJvamVjdFRhc2tCdG4pO1xuICAgICAgICBwcm9qZWN0RGlzcGxheS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuXG4gICAgICAgIHJldHVybiBwcm9qZWN0RGlzcGxheVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3BsYXlQcm9qZWN0VGFza3MoaWQpIHtcbiAgICAgICAgbGV0IGxpc3QgPSBwcm9qZWN0cy5wcm9qZWN0TGlzdDtcbiAgICAgICAgY29uc3QgZ2VuZXJhbExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZ2VuZXJhbCcpO1xuICAgICAgICBnZW5lcmFsTGlzdC5jbGFzc0xpc3QucmVwbGFjZShnZW5lcmFsTGlzdC5nZXRBdHRyaWJ1dGUoJ2NsYXNzJyksIGBwcm9qZWN0LSR7aWR9YCk7XG5cbiAgICAgICAgd2hpbGUgKGdlbmVyYWxMaXN0Lmxhc3RFbGVtZW50Q2hpbGQpIGdlbmVyYWxMaXN0LnJlbW92ZUNoaWxkKGdlbmVyYWxMaXN0Lmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gICAgICAgIGxldCBwcm9qZWN0VGFza3MgPSBwcm9qZWN0cy5ncmFiQ3VycmVudFByb2plY3RUYXNrcyhpZCk7XG5cbiAgICAgICAgcHJvamVjdFRhc2tzLmZvckVhY2godGFzayA9PiByZW5kZXJUYXNrLmRpc3BsYXlBbGxUYXNrKHRhc2ssIGdlbmVyYWxMaXN0KSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZGlzcGxheVByb2plY3QsIGRpc3BsYXlQcm9qZWN0VGFza3MgfVxufSkoKVxuXG5leHBvcnQgeyByZW5kZXJUYXNrLCByZW5kZXJQcm9qZWN0IH0iLCJpbXBvcnQgeyBBZGR0b0xpc3QgfSBmcm9tIFwiLi9tYW5hZ2VMaXN0XCI7XG5pbXBvcnQgeyByZW5kZXJUYXNrIH0gZnJvbSBcIi4vVUlcIjtcbmltcG9ydCB7IHByb2plY3RzIH0gZnJvbSBcIi4vbWFuYWdlUHJvamVjdFwiO1xuaW1wb3J0IHsgdG9EYXRlLCBpc1RoaXNXZWVrLCBpc1RvZGF5IH0gZnJvbSBcImRhdGUtZm5zXCI7XG5cblxuY29uc3QgY3JlYXRlVGFzayA9IChpZCwgdGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVkYXRlLCBwcmlvcml0eSwgcHJvamVjdCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIGlkLCB0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZWRhdGUsIHByaW9yaXR5LCBwcm9qZWN0XG4gICAgfVxufVxuXG5jb25zdCBOZXdUYXNrID0gKCgpID0+IHtcblxuICAgIGxldCB0aXRsZTtcbiAgICBsZXQgZGVzY3JpcHRpb247XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVOZXdUYXNrKCkge1xuICAgICAgICBjb25zdCBwcm9qZWN0TGlzdCA9IHByb2plY3RzLmdyYWJQcm9qZWN0TGlzdCgpO1xuXG4gICAgICAgIHRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpdGxlJykudmFsdWU7XG4gICAgICAgIGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2NyaXB0aW9uJykudmFsdWU7XG5cbiAgICAgICAgbGV0IGR1ZWRhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZScpLnZhbHVlO1xuICAgICAgICBsZXQgcHJpb3JpdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpb3JpdHknKS52YWx1ZTtcbiAgICAgICAgbGV0IGlkID0gY3JlYXRlSWQoKTtcbiAgICAgICAgbGV0IHByb2plY3RJZCA9IHByb2plY3RzLmdyYWJDdXJyZW50UHJvamVjdCgpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKGlzVGhpc1dlZWsodG9EYXRlKGR1ZWRhdGUpKSlcbiAgICAgICAgY29uc29sZS5sb2coaXNUb2RheSh0b0RhdGUoZHVlZGF0ZSkpKVxuXG4gICAgICAgIGlmICh0aXRsZSA9PT0gJycgfHxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uID09PSAnJyB8fFxuICAgICAgICAgICAgZHVlZGF0ZSA9PT0gJycpIHJldHVyblxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHRhc2sgPSBjcmVhdGVUYXNrKGlkLCB0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZWRhdGUsIHByaW9yaXR5LCBwcm9qZWN0SWQpO1xuICAgICAgICAgICAgY29uc29sZS5sb2codGFzayk7XG5cbiAgICAgICAgICAgIGlmIChwcm9qZWN0SWQgPT09IDApIHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0TGlzdFswXS50YXNrTGlzdC5wdXNoKHRhc2spO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RMaXN0KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHByb2plY3RMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb2plY3RMaXN0W2ldLmlkID09PSBwcm9qZWN0SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQWRkdG9MaXN0LmFkZFRvTGlzdCh0YXNrKTtcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdExpc3RbaV0udGFza0xpc3QucHVzaCh0YXNrKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocHJvamVjdExpc3QpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUlkKCkge1xuICAgICAgICBsZXQgbGlzdCA9IHByb2plY3RzLnByb2plY3RMaXN0WzBdLnRhc2tMaXN0O1xuICAgICAgICBsZXQgaWQ7XG5cbiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gaWQgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGlkID0gbGlzdFtsaXN0Lmxlbmd0aC0xXS5pZCArIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgbGV0IHRpdGxlVmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGl0bGUnKTtcbiAgICAgICAgdGl0bGVWYWx1ZS52YWx1ZSA9ICcnO1xuICAgICAgICB0aXRsZSA9ICcnO1xuXG4gICAgICAgIGxldCBkZXNjcmlwdGlvblZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2NyaXB0aW9uJyk7XG4gICAgICAgIGRlc2NyaXB0aW9uVmFsdWUudmFsdWUgPSAnJztcbiAgICAgICAgZGVzY3JpcHRpb24gPSAnJztcblxuICAgICAgICBsZXQgZHVlZGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlJyk7XG4gICAgICAgIGR1ZWRhdGUudmFsdWUgPSAnJztcblxuICAgICAgICBsZXQgcHJpb3JpdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpb3JpdHknKTtcbiAgICAgICAgcHJpb3JpdHkudmFsdWUgPSAnTG93JztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0U3VibWl0QnRuKCkge1xuICAgICAgICBjb25zdCBzdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3VibWl0Jyk7XG5cbiAgICAgICAgc3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIHN1Ym1pdFRhc2soKTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFRhc2soKSB7XG4gICAgICAgIGNvbnN0IG5ld1Rhc2tGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21haW4tZm9ybScpO1xuICAgICAgICBjb25zdCBuZXdUYXNrQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ld1Rhc2snKTtcbiAgICAgICAgXG4gICAgICAgIGNyZWF0ZU5ld1Rhc2soKTtcblxuICAgICAgICBpZiAodGl0bGUgPT09ICcnIHx8IGRlc2NyaXB0aW9uID09PSAnJykgcmV0dXJuXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGV0IHRhc2tMaXN0ID0gcHJvamVjdHMucHJvamVjdExpc3RbMF0udGFza0xpc3RcbiAgICAgICAgICAgIGxldCBwcm9qZWN0SWQgPSB0YXNrTGlzdFt0YXNrTGlzdC5sZW5ndGggLSAxXS5wcm9qZWN0OyBcbiAgICAgICAgICAgIHJlbmRlclRhc2sudXBkYXRlRGlzcGxheShwcm9qZWN0SWQpO1xuICAgICAgICAgICAgcmVzZXQoKTtcbiAgICAgICAgICAgIG5ld1Rhc2tGb3JtLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJycpO1xuICAgICAgICAgICAgbmV3VGFza0J0bi5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FuY2VsVGFzaygpIHtcbiAgICAgICAgY29uc3QgY2FuY2VsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NhbmNlbCcpO1xuICAgICAgICBjb25zdCBuZXdUYXNrRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtYWluLWZvcm0nKTtcbiAgICAgICAgY29uc3QgbmV3VGFza0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuZXdUYXNrJyk7XG5cbiAgICAgICAgY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIHJlc2V0KCk7XG4gICAgICAgICAgICBuZXdUYXNrRm9ybS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgICAgICAgIG5ld1Rhc2tCdG4ucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvcGVuVGFza0NyZWF0b3IoKSB7XG4gICAgICAgIGNvbnN0IG5ld1Rhc2tCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmV3VGFzaycpO1xuICAgICAgICBjb25zdCBuZXdUYXNrRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtYWluLWZvcm0nKTtcblxuICAgICAgICBuZXdUYXNrQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIHByb2plY3RzLmdyYWJQcm9qZWN0SWQoZSk7XG4gICAgICAgICAgICBuZXdUYXNrRm9ybS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuICAgICAgICAgICAgbmV3VGFza0J0bi5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4geyBjcmVhdGVOZXdUYXNrLCBpbml0U3VibWl0QnRuLCBjYW5jZWxUYXNrLCBvcGVuVGFza0NyZWF0b3IgfVxufSkoKTtcblxuZXhwb3J0IHsgTmV3VGFzayB9XG4iLCJpbXBvcnQgeyBOZXdUYXNrIH0gZnJvbSBcIi4vbWFuYWdlVGFzay5qc1wiO1xuaW1wb3J0IHsgcHJvamVjdHMgfSBmcm9tIFwiLi9tYW5hZ2VQcm9qZWN0LmpzXCI7XG5pbXBvcnQgeyByZW5kZXJUYXNrIH0gZnJvbSBcIi4vVUkuanNcIjtcblxuTmV3VGFzay5pbml0U3VibWl0QnRuKCk7XG5OZXdUYXNrLmNhbmNlbFRhc2soKTtcbk5ld1Rhc2sub3BlblRhc2tDcmVhdG9yKCk7XG5cbnByb2plY3RzLnN1Ym1pdFByb2plY3QoKTtcblxuY29uc3QgdG9kYXlUYWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdG9kYXknKTtcbmNvbnN0IHdlZWtUYWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjd2Vla2x5Jyk7XG5jb25zdCBpbmJveFRhYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNpbmJveCcpO1xuXG50b2RheVRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycscmVuZGVyVGFzay5kaXNwbGF5RGFpbHkpO1xud2Vla1RhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlbmRlclRhc2suZGlzcGxheVdlZWtseSk7XG5pbmJveFRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlbmRlclRhc2suZGlzcGxheUluYm94KTsiXSwibmFtZXMiOlsiQWRkdG9MaXN0IiwiVG9kb0xpc3QiLCJhZGRUb0xpc3QiLCJ0YXNrIiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmVUYXNrIiwiaWQiLCJmaWx0ZXIiLCJuZXdQcm9qZWN0IiwidGl0bGUiLCJ0YXNrTGlzdCIsInByb2plY3RzIiwicHJvamVjdFRpdGxlIiwicHJvamVjdExpc3QiLCJnZW5lcmFsTGlzdCIsImN1cnJlbnRQcm9qZWN0Iiwic3VibWl0UHJvamVjdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsInByb2plY3RJZCIsImxlbmd0aCIsInByb2plY3QiLCJhZGRUb1Byb2plY3RMaXN0IiwiY3JlYXRlUHJvamVjdCIsInJlbmRlclByb2plY3QiLCJkaXNwbGF5UHJvamVjdCIsImdyYWJQcm9qZWN0SWQiLCJwYXJzZUludCIsInRhcmdldCIsImdldEF0dHJpYnV0ZSIsImdyYWJDdXJyZW50UHJvamVjdCIsImdyYWJQcm9qZWN0TGlzdCIsInVwZGF0ZUdlbmVyYWxMaXN0IiwibmV3TGlzdCIsInVwZGF0ZVByb2plY3RMaXN0IiwidXBkYXRlIiwiZ3JhYkN1cnJlbnRQcm9qZWN0VGFza3MiLCJ0b0RhdGUiLCJhcmd1bWVudCIsImFyZ1N0ciIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiY2FsbCIsIkRhdGUiLCJjb25zdHJ1Y3RvciIsIk5hTiIsInN0YXJ0T2ZEYXkiLCJkYXRlIiwiX2RhdGUiLCJzZXRIb3VycyIsImlzVG9kYXkiLCJkYXRlTGVmdCIsImRhdGVSaWdodCIsIm5vdyIsImRlZmF1bHRPcHRpb25zIiwiZ2V0RGVmYXVsdE9wdGlvbnMiLCJzdGFydE9mV2VlayIsIm9wdGlvbnMiLCJ3ZWVrU3RhcnRzT24iLCJsb2NhbGUiLCJkYXkiLCJnZXREYXkiLCJkaWZmIiwic2V0RGF0ZSIsImdldERhdGUiLCJpc1RoaXNXZWVrIiwiaXNTYW1lV2VlayIsInJlbmRlclRhc2siLCJkaXNwbGF5QWxsVGFzayIsIml0ZW1zIiwiZGlzcGxheSIsImNvbnRhaW5lciIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJjbGFzc0xpc3QiLCJhZGQiLCJkdWVkYXRlIiwiZGVzY3JpcHRpb24iLCJwcmlvcml0eSIsImRlbGV0ZUJ0biIsInRleHRDb250ZW50IiwiQWxsdGFzayIsImxhc3RFbGVtZW50Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInVwZGF0ZURpc3BsYXkiLCJpbml0RGVsQnRuIiwiYXBwZW5kIiwiYXBwZW5kQ2hpbGQiLCJ0YWIiLCJkaXNwbGF5SW5ib3giLCJkaXNwbGF5RGFpbHkiLCJkaXNwbGF5V2Vla2x5IiwiZGlzcGxheVByb2plY3RUYXNrcyIsImxpc3QiLCJyZXBsYWNlIiwiZm9yRWFjaCIsImRpc3BsYXlOZXdJbnB1dCIsInByb2plY3REaXNwbGF5IiwicHJvamVjdFRhc2tCdG4iLCJzdG9wUHJvcGFnYXRpb24iLCJuZXdUYXNrRm9ybSIsInJlbW92ZUF0dHJpYnV0ZSIsIk5ld1Rhc2siLCJjcmVhdGVOZXdUYXNrIiwiZ2V0RWxlbWVudEJ5SWQiLCJjcmVhdGVJZCIsImNyZWF0ZVRhc2siLCJpIiwicmVzZXQiLCJpbml0U3VibWl0QnRuIiwibmV3VGFza0J0biIsInN1Ym1pdFRhc2siLCJjYW5jZWxUYXNrIiwiY2FuY2VsQnRuIiwib3BlblRhc2tDcmVhdG9yIiwidG9kYXlUYWIiLCJ3ZWVrVGFiIiwiaW5ib3hUYWIiXSwic291cmNlUm9vdCI6IiJ9