(()=>{"use strict";const t=(()=>{let t=[];return{addToList:function(e){t.push(e),console.log(t)},TodoList:t}})(),e=(t,e,n)=>({title:t,taskList:e,id:n}),n=(()=>{let n,o=[],r=t.TodoList;const c=e("General",r,0);o.push(c);let i=0;return{submitProject:function(){document.querySelector("#createProject").addEventListener("click",(t=>{t.preventDefault(),function(){n=document.querySelector("#projectTitle").value;const t=0===o.length?0:o[o.length-1].id+1;if(""!==n){const r=e(n,[],t);console.log(r),function(t){o.push(t),console.log(o)}(r)}}(),""!==n&&(u.displayProject(),document.querySelector("#projectTitle").value="",n="")}))},grabProjectId:function(t){let e=parseInt(t.target.getAttribute("data-projectId"));return i=e,i},grabCurrentProject:function(){return i},grabProjectList:function(){return o},projectList:o}})();function o(t){const e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new t.constructor(+t):"number"==typeof t||"[object Number]"===e||"string"==typeof t||"[object String]"===e?new Date(t):new Date(NaN)}function r(t){const e=o(t);return e.setHours(0,0,0,0),e}function c(t){return e=t,n=Date.now(),+r(e)==+r(n);var e,n}const i=(()=>{function t(t,e){const n=document.createElement("div");n.setAttribute("data-taskId",`${t.id}`);const o=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),i=document.createElement("div");return o.textContent=`Title: ${t.title}`,r.textContent=`Due Date: ${t.duedate}`,c.textContent=`Description: ${t.description}`,i.textContent=`Priority: ${t.priority}`,n.append(o,r,c,i),e.appendChild(n),e}return{displayInbox:function(){let e=n.projectList[0].taskList;t(e[e.length-1],document.querySelector("#general"))},displayDaily:function(){let e=n.projectList[0].taskList;const r=document.querySelector("#general");for(;r.lastElementChild;)r.removeChild(r.lastElementChild);e.filter((t=>c(o(t.duedate)))).forEach((e=>{t(e,r)}))}}})(),u={displayProject:function(){let t=n.projectList,e=t[t.length-1];const o=document.querySelector(".all-projects"),r=document.createElement("div"),c=document.createElement("div"),i=document.createElement("button");return r.classList.add("project"),r.setAttribute("data-projectId",`${e.id}`),i.setAttribute("data-projectId",`${e.id}`),i.setAttribute("id",`project-${e.id}`),c.textContent=`${e.title}`,i.textContent="+",i.addEventListener("click",(t=>{console.log("project id",n.grabProjectId(t));const e=document.querySelector("#main-form");n.grabProjectId(t),e.removeAttribute("hidden"),t.preventDefault()})),r.append(c,i),o.appendChild(r),o}};let d={};function l(){return d}function a(t,e){const n=l(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=o(t),i=c.getDay(),u=(i<r?7:0)+i-r;return c.setDate(c.getDate()-u),c.setHours(0,0,0,0),c}function s(t,e){return function(t,e,n){return+a(t,n)==+a(e,n)}(t,Date.now(),e)}const m=(()=>{let e,r;function u(){const i=n.grabProjectList();e=document.getElementById("title").value,r=document.getElementById("description").value;let u=document.getElementById("date").value,d=document.getElementById("priority").value,l=function(){let e=t.TodoList;return 0===e.length?0:e[e.length-1].id+1}(),a=n.grabCurrentProject();if(console.log(s(o(u))),console.log(c(o(u))),""!==e&&""!==r&&""!==u){const n=((t,e,n,o,r,c)=>({id:t,title:e,description:n,duedate:o,priority:r,project:c}))(l,e,r,u,d,a);console.log(n),0===a&&(i[0].taskList.push(n),console.log(i));for(let e=1;e<i.length;e++)i[e].id===a&&(t.addToList(n),i[e].taskList.push(n),console.log(i))}}function d(){document.getElementById("title").value="",e="",document.getElementById("description").value="",r="",document.getElementById("date").value="",document.getElementById("priority").value="Low"}return{createNewTask:u,initSubmitBtn:function(){document.querySelector("#submit").addEventListener("click",(t=>{!function(){const t=document.querySelector("#main-form"),n=document.querySelector("#newTask");u(),""!==e&&""!==r&&(i.displayInbox(),d(),t.setAttribute("hidden",""),n.removeAttribute("hidden"))}(),t.preventDefault()}))},cancelTask:function(){const t=document.querySelector("#cancel"),e=document.querySelector("#main-form"),n=document.querySelector("#newTask");t.addEventListener("click",(t=>{d(),e.setAttribute("hidden",""),n.removeAttribute("hidden"),t.preventDefault()}))},openTaskCreator:function(){const t=document.querySelector("#newTask"),e=document.querySelector("#main-form");t.addEventListener("click",(o=>{n.grabProjectId(o),e.removeAttribute("hidden"),t.setAttribute("hidden",""),o.preventDefault()}))}}})();m.initSubmitBtn(),m.cancelTask(),m.openTaskCreator(),n.submitProject(),document.querySelector("#today").addEventListener("click",(()=>{i.displayDaily()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixVQUVuQyxDQWxCUXVCLEdBQ0FsRixFQUFFQyxnQkFBZ0IsR0FFMUIsRUEwQ3VDa0YsV0F6QnZDLFdBQ0ksTUFBTUMsRUFBWXZGLFNBQVNDLGNBQWMsV0FDbkM0RCxFQUFjN0QsU0FBU0MsY0FBYyxjQUNyQ21GLEVBQWFwRixTQUFTQyxjQUFjLFlBRTFDc0YsRUFBVXJGLGlCQUFpQixTQUFVQyxJQUNqQytFLElBQ0FyQixFQUFZbEIsYUFBYSxTQUFVLElBQ25DeUMsRUFBV3RCLGdCQUFnQixVQUMzQjNELEVBQUVDLGdCQUFnQixHQUUxQixFQWNtRG9GLGdCQVpuRCxXQUNJLE1BQU1KLEVBQWFwRixTQUFTQyxjQUFjLFlBQ3BDNEQsRUFBYzdELFNBQVNDLGNBQWMsY0FFM0NtRixFQUFXbEYsaUJBQWlCLFNBQVVDLElBQ2xDVCxFQUFTbUIsY0FBY1YsR0FDdkIwRCxFQUFZQyxnQkFBZ0IsVUFDNUJzQixFQUFXekMsYUFBYSxTQUFVLElBQ2xDeEMsRUFBRUMsZ0JBQWdCLEdBRTFCLEVBR0gsRUF0SGUsR0NSaEJ3RSxFQUFRTyxnQkFDUlAsRUFBUVUsYUFDUlYsRUFBUVksa0JBRVI5RixFQUFTSyxnQkFFUUMsU0FBU0MsY0FBYyxVQUUvQkMsaUJBQWlCLFNBQVMsS0FDL0JtQyxFQUFXZSxjQUFjLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbWFuYWdlTGlzdC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbWFuYWdlUHJvamVjdC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvdG9EYXRlLm1qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvc3RhcnRPZkRheS5tanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2lzVG9kYXkubWpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9pc1NhbWVEYXkubWpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9VSS5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvX2xpYi9kZWZhdWx0T3B0aW9ucy5tanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL3N0YXJ0T2ZXZWVrLm1qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvaXNUaGlzV2Vlay5tanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2lzU2FtZVdlZWsubWpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9tYW5hZ2VUYXNrLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBBZGR0b0xpc3QgPSAoKCkgPT4ge1xuICAgIGxldCBUb2RvTGlzdCA9IFtdO1xuXG4gICAgZnVuY3Rpb24gYWRkVG9MaXN0KHRhc2spIHtcbiAgICAgICAgVG9kb0xpc3QucHVzaCh0YXNrKTtcbiAgICAgICAgY29uc29sZS5sb2coVG9kb0xpc3QpO1xuICAgIH1cblxuICAgIHJldHVybiB7IGFkZFRvTGlzdCwgVG9kb0xpc3QgfTtcbn0pKClcblxuXG5leHBvcnQgeyBBZGR0b0xpc3QgfSIsImltcG9ydCB7IHJlbmRlclByb2plY3QgfSBmcm9tIFwiLi9VSVwiO1xuaW1wb3J0IHsgQWRkdG9MaXN0IH0gZnJvbSBcIi4vbWFuYWdlTGlzdFwiO1xuaW1wb3J0IHsgTmV3VGFzayB9IGZyb20gXCIuL21hbmFnZVRhc2tcIjtcblxuY29uc3QgbmV3UHJvamVjdCA9ICh0aXRsZSwgdGFza0xpc3QsIGlkKSA9PiB7XG4gICAgcmV0dXJuIHsgdGl0bGUsIHRhc2tMaXN0LCBpZCB9O1xufVxuXG5jb25zdCBwcm9qZWN0cyA9ICgoKSA9PiB7XG4gICAgbGV0IHByb2plY3RUaXRsZVxuICAgIGxldCBwcm9qZWN0TGlzdCA9IFtdO1xuXG4gICAgbGV0IHRhc2tMaXN0ID0gQWRkdG9MaXN0LlRvZG9MaXN0O1xuXG4gICAgY29uc3QgZ2VuZXJhbExpc3QgPSBuZXdQcm9qZWN0KCdHZW5lcmFsJywgdGFza0xpc3QsIDApO1xuICAgIHByb2plY3RMaXN0LnB1c2goZ2VuZXJhbExpc3QpO1xuXG4gICAgbGV0IGN1cnJlbnRQcm9qZWN0ID0gMDtcblxuICAgIGZ1bmN0aW9uIGdyYWJDdXJyZW50UHJvamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRQcm9qZWN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdyYWJQcm9qZWN0TGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIHByb2plY3RMaXN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QoKSB7XG4gICAgICAgIHByb2plY3RUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0VGl0bGUnKS52YWx1ZTtcbiAgICAgICAgY29uc3QgcHJvamVjdElkID0gY3JlYXRlUHJvamVjdElkKClcbiAgICAgICAgY29uc3QgcHJvamVjdFRhc2tzID0gW107XG5cbiAgICAgICAgaWYgKHByb2plY3RUaXRsZSA9PT0gJycpIHJldHVyblxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3QgPSBuZXdQcm9qZWN0KHByb2plY3RUaXRsZSwgcHJvamVjdFRhc2tzLCBwcm9qZWN0SWQpO1xuICAgICAgICAgICAgY29uc29sZS5sb2cocHJvamVjdCk7XG4gICAgICAgICAgICBhZGRUb1Byb2plY3RMaXN0KHByb2plY3QpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlUHJvamVjdElkKCkge1xuICAgICAgICBsZXQgaWQ7XG4gICAgICAgIGlmIChwcm9qZWN0TGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBpZCA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaWQgPSBwcm9qZWN0TGlzdFtwcm9qZWN0TGlzdC5sZW5ndGggLSAxXS5pZCArIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRUb1Byb2plY3RMaXN0KHByb2plY3QpIHtcbiAgICAgICAgcHJvamVjdExpc3QucHVzaChwcm9qZWN0KTtcbiAgICAgICAgY29uc29sZS5sb2cocHJvamVjdExpc3QpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgICBsZXQgcHJvamVjdFRpdGxlVmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdFRpdGxlJyk7XG4gICAgICAgIHByb2plY3RUaXRsZVZhbHVlLnZhbHVlID0gJyc7XG4gICAgICAgIHByb2plY3RUaXRsZSA9ICcnO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFByb2plY3QoKSB7XG4gICAgICAgIGNvbnN0IGNyZWF0ZVByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY3JlYXRlUHJvamVjdCcpO1xuXG4gICAgICAgIGNyZWF0ZVByb2plY3RCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjcmVhdGVQcm9qZWN0KCk7XG4gICAgICAgICAgICBpZiAocHJvamVjdFRpdGxlID09PSAnJykgcmV0dXJuXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZW5kZXJQcm9qZWN0LmRpc3BsYXlQcm9qZWN0KCk7XG4gICAgICAgICAgICAgICAgcmVzZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBncmFiUHJvamVjdElkKGUpIHtcbiAgICAgICAgbGV0IHByb2plY3RJZCA9IHBhcnNlSW50KGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1wcm9qZWN0SWQnKSk7XG5cbiAgICAgICAgY3VycmVudFByb2plY3QgPSBwcm9qZWN0SWQ7XG5cbiAgICAgICAgcmV0dXJuIGN1cnJlbnRQcm9qZWN0O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Ym1pdFByb2plY3QsIGdyYWJQcm9qZWN0SWQsIGdyYWJDdXJyZW50UHJvamVjdCwgZ3JhYlByb2plY3RMaXN0LCBwcm9qZWN0TGlzdCB9XG59KSgpXG5cbmV4cG9ydCB7IHByb2plY3RzIH1cblxuIiwiLyoqXG4gKiBAbmFtZSB0b0RhdGVcbiAqIEBjYXRlZ29yeSBDb21tb24gSGVscGVyc1xuICogQHN1bW1hcnkgQ29udmVydCB0aGUgZ2l2ZW4gYXJndW1lbnQgdG8gYW4gaW5zdGFuY2Ugb2YgRGF0ZS5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbnZlcnQgdGhlIGdpdmVuIGFyZ3VtZW50IHRvIGFuIGluc3RhbmNlIG9mIERhdGUuXG4gKlxuICogSWYgdGhlIGFyZ3VtZW50IGlzIGFuIGluc3RhbmNlIG9mIERhdGUsIHRoZSBmdW5jdGlvbiByZXR1cm5zIGl0cyBjbG9uZS5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgYSBudW1iZXIsIGl0IGlzIHRyZWF0ZWQgYXMgYSB0aW1lc3RhbXAuXG4gKlxuICogSWYgdGhlIGFyZ3VtZW50IGlzIG5vbmUgb2YgdGhlIGFib3ZlLCB0aGUgZnVuY3Rpb24gcmV0dXJucyBJbnZhbGlkIERhdGUuXG4gKlxuICogKipOb3RlKio6ICphbGwqIERhdGUgYXJndW1lbnRzIHBhc3NlZCB0byBhbnkgKmRhdGUtZm5zKiBmdW5jdGlvbiBpcyBwcm9jZXNzZWQgYnkgYHRvRGF0ZWAuXG4gKlxuICogQHR5cGVQYXJhbSBEYXRlVHlwZSAtIFRoZSBgRGF0ZWAgdHlwZSwgdGhlIGZ1bmN0aW9uIG9wZXJhdGVzIG9uLiBHZXRzIGluZmVycmVkIGZyb20gcGFzc2VkIGFyZ3VtZW50cy4gQWxsb3dzIHRvIHVzZSBleHRlbnNpb25zIGxpa2UgW2BVVENEYXRlYF0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL3V0YykuXG4gKlxuICogQHBhcmFtIGFyZ3VtZW50IC0gVGhlIHZhbHVlIHRvIGNvbnZlcnRcbiAqXG4gKiBAcmV0dXJucyBUaGUgcGFyc2VkIGRhdGUgaW4gdGhlIGxvY2FsIHRpbWUgem9uZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBDbG9uZSB0aGUgZGF0ZTpcbiAqIGNvbnN0IHJlc3VsdCA9IHRvRGF0ZShuZXcgRGF0ZSgyMDE0LCAxLCAxMSwgMTEsIDMwLCAzMCkpXG4gKiAvLz0+IFR1ZSBGZWIgMTEgMjAxNCAxMTozMDozMFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBDb252ZXJ0IHRoZSB0aW1lc3RhbXAgdG8gZGF0ZTpcbiAqIGNvbnN0IHJlc3VsdCA9IHRvRGF0ZSgxMzkyMDk4NDMwMDAwKVxuICogLy89PiBUdWUgRmViIDExIDIwMTQgMTE6MzA6MzBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvRGF0ZShhcmd1bWVudCkge1xuICBjb25zdCBhcmdTdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJndW1lbnQpO1xuXG4gIC8vIENsb25lIHRoZSBkYXRlXG4gIGlmIChcbiAgICBhcmd1bWVudCBpbnN0YW5jZW9mIERhdGUgfHxcbiAgICAodHlwZW9mIGFyZ3VtZW50ID09PSBcIm9iamVjdFwiICYmIGFyZ1N0ciA9PT0gXCJbb2JqZWN0IERhdGVdXCIpXG4gICkge1xuICAgIC8vIFByZXZlbnQgdGhlIGRhdGUgdG8gbG9zZSB0aGUgbWlsbGlzZWNvbmRzIHdoZW4gcGFzc2VkIHRvIG5ldyBEYXRlKCkgaW4gSUUxMFxuICAgIHJldHVybiBuZXcgYXJndW1lbnQuY29uc3RydWN0b3IoK2FyZ3VtZW50KTtcbiAgfSBlbHNlIGlmIChcbiAgICB0eXBlb2YgYXJndW1lbnQgPT09IFwibnVtYmVyXCIgfHxcbiAgICBhcmdTdHIgPT09IFwiW29iamVjdCBOdW1iZXJdXCIgfHxcbiAgICB0eXBlb2YgYXJndW1lbnQgPT09IFwic3RyaW5nXCIgfHxcbiAgICBhcmdTdHIgPT09IFwiW29iamVjdCBTdHJpbmddXCJcbiAgKSB7XG4gICAgLy8gVE9ETzogQ2FuIHdlIGdldCByaWQgb2YgYXM/XG4gICAgcmV0dXJuIG5ldyBEYXRlKGFyZ3VtZW50KTtcbiAgfSBlbHNlIHtcbiAgICAvLyBUT0RPOiBDYW4gd2UgZ2V0IHJpZCBvZiBhcz9cbiAgICByZXR1cm4gbmV3IERhdGUoTmFOKTtcbiAgfVxufVxuXG4vLyBGYWxsYmFjayBmb3IgbW9kdWxhcml6ZWQgaW1wb3J0czpcbmV4cG9ydCBkZWZhdWx0IHRvRGF0ZTtcbiIsImltcG9ydCB7IHRvRGF0ZSB9IGZyb20gXCIuL3RvRGF0ZS5tanNcIjtcblxuLyoqXG4gKiBAbmFtZSBzdGFydE9mRGF5XG4gKiBAY2F0ZWdvcnkgRGF5IEhlbHBlcnNcbiAqIEBzdW1tYXJ5IFJldHVybiB0aGUgc3RhcnQgb2YgYSBkYXkgZm9yIHRoZSBnaXZlbiBkYXRlLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogUmV0dXJuIHRoZSBzdGFydCBvZiBhIGRheSBmb3IgdGhlIGdpdmVuIGRhdGUuXG4gKiBUaGUgcmVzdWx0IHdpbGwgYmUgaW4gdGhlIGxvY2FsIHRpbWV6b25lLlxuICpcbiAqIEB0eXBlUGFyYW0gRGF0ZVR5cGUgLSBUaGUgYERhdGVgIHR5cGUsIHRoZSBmdW5jdGlvbiBvcGVyYXRlcyBvbi4gR2V0cyBpbmZlcnJlZCBmcm9tIHBhc3NlZCBhcmd1bWVudHMuIEFsbG93cyB0byB1c2UgZXh0ZW5zaW9ucyBsaWtlIFtgVVRDRGF0ZWBdKGh0dHBzOi8vZ2l0aHViLmNvbS9kYXRlLWZucy91dGMpLlxuICpcbiAqIEBwYXJhbSBkYXRlIC0gVGhlIG9yaWdpbmFsIGRhdGVcbiAqXG4gKiBAcmV0dXJucyBUaGUgc3RhcnQgb2YgYSBkYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gVGhlIHN0YXJ0IG9mIGEgZGF5IGZvciAyIFNlcHRlbWJlciAyMDE0IDExOjU1OjAwOlxuICogY29uc3QgcmVzdWx0ID0gc3RhcnRPZkRheShuZXcgRGF0ZSgyMDE0LCA4LCAyLCAxMSwgNTUsIDApKVxuICogLy89PiBUdWUgU2VwIDAyIDIwMTQgMDA6MDA6MDBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0T2ZEYXkoZGF0ZSkge1xuICBjb25zdCBfZGF0ZSA9IHRvRGF0ZShkYXRlKTtcbiAgX2RhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gIHJldHVybiBfZGF0ZTtcbn1cblxuLy8gRmFsbGJhY2sgZm9yIG1vZHVsYXJpemVkIGltcG9ydHM6XG5leHBvcnQgZGVmYXVsdCBzdGFydE9mRGF5O1xuIiwiaW1wb3J0IHsgaXNTYW1lRGF5IH0gZnJvbSBcIi4vaXNTYW1lRGF5Lm1qc1wiO1xuXG4vKipcbiAqIEBuYW1lIGlzVG9kYXlcbiAqIEBjYXRlZ29yeSBEYXkgSGVscGVyc1xuICogQHN1bW1hcnkgSXMgdGhlIGdpdmVuIGRhdGUgdG9kYXk/XG4gKiBAcHVyZSBmYWxzZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSXMgdGhlIGdpdmVuIGRhdGUgdG9kYXk/XG4gKlxuICogQHR5cGVQYXJhbSBEYXRlVHlwZSAtIFRoZSBgRGF0ZWAgdHlwZSwgdGhlIGZ1bmN0aW9uIG9wZXJhdGVzIG9uLiBHZXRzIGluZmVycmVkIGZyb20gcGFzc2VkIGFyZ3VtZW50cy4gQWxsb3dzIHRvIHVzZSBleHRlbnNpb25zIGxpa2UgW2BVVENEYXRlYF0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL3V0YykuXG4gKlxuICogQHBhcmFtIGRhdGUgLSBUaGUgZGF0ZSB0byBjaGVja1xuICpcbiAqIEByZXR1cm5zIFRoZSBkYXRlIGlzIHRvZGF5XG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElmIHRvZGF5IGlzIDYgT2N0b2JlciAyMDE0LCBpcyA2IE9jdG9iZXIgMTQ6MDA6MDAgdG9kYXk/XG4gKiBjb25zdCByZXN1bHQgPSBpc1RvZGF5KG5ldyBEYXRlKDIwMTQsIDksIDYsIDE0LCAwKSlcbiAqIC8vPT4gdHJ1ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNUb2RheShkYXRlKSB7XG4gIHJldHVybiBpc1NhbWVEYXkoZGF0ZSwgRGF0ZS5ub3coKSk7XG59XG5cbi8vIEZhbGxiYWNrIGZvciBtb2R1bGFyaXplZCBpbXBvcnRzOlxuZXhwb3J0IGRlZmF1bHQgaXNUb2RheTtcbiIsImltcG9ydCB7IHN0YXJ0T2ZEYXkgfSBmcm9tIFwiLi9zdGFydE9mRGF5Lm1qc1wiO1xuXG4vKipcbiAqIEBuYW1lIGlzU2FtZURheVxuICogQGNhdGVnb3J5IERheSBIZWxwZXJzXG4gKiBAc3VtbWFyeSBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIGRheSAoYW5kIHllYXIgYW5kIG1vbnRoKT9cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEFyZSB0aGUgZ2l2ZW4gZGF0ZXMgaW4gdGhlIHNhbWUgZGF5IChhbmQgeWVhciBhbmQgbW9udGgpP1xuICpcbiAqIEB0eXBlUGFyYW0gRGF0ZVR5cGUgLSBUaGUgYERhdGVgIHR5cGUsIHRoZSBmdW5jdGlvbiBvcGVyYXRlcyBvbi4gR2V0cyBpbmZlcnJlZCBmcm9tIHBhc3NlZCBhcmd1bWVudHMuIEFsbG93cyB0byB1c2UgZXh0ZW5zaW9ucyBsaWtlIFtgVVRDRGF0ZWBdKGh0dHBzOi8vZ2l0aHViLmNvbS9kYXRlLWZucy91dGMpLlxuICpcbiAqIEBwYXJhbSBkYXRlTGVmdCAtIFRoZSBmaXJzdCBkYXRlIHRvIGNoZWNrXG4gKiBAcGFyYW0gZGF0ZVJpZ2h0IC0gVGhlIHNlY29uZCBkYXRlIHRvIGNoZWNrXG5cbiAqIEByZXR1cm5zIFRoZSBkYXRlcyBhcmUgaW4gdGhlIHNhbWUgZGF5IChhbmQgeWVhciBhbmQgbW9udGgpXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIEFyZSA0IFNlcHRlbWJlciAwNjowMDowMCBhbmQgNCBTZXB0ZW1iZXIgMTg6MDA6MDAgaW4gdGhlIHNhbWUgZGF5P1xuICogY29uc3QgcmVzdWx0ID0gaXNTYW1lRGF5KG5ldyBEYXRlKDIwMTQsIDgsIDQsIDYsIDApLCBuZXcgRGF0ZSgyMDE0LCA4LCA0LCAxOCwgMCkpXG4gKiAvLz0+IHRydWVcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQXJlIDQgU2VwdGVtYmVyIGFuZCA0IE9jdG9iZXIgaW4gdGhlIHNhbWUgZGF5P1xuICogY29uc3QgcmVzdWx0ID0gaXNTYW1lRGF5KG5ldyBEYXRlKDIwMTQsIDgsIDQpLCBuZXcgRGF0ZSgyMDE0LCA5LCA0KSlcbiAqIC8vPT4gZmFsc2VcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQXJlIDQgU2VwdGVtYmVyLCAyMDE0IGFuZCA0IFNlcHRlbWJlciwgMjAxNSBpbiB0aGUgc2FtZSBkYXk/XG4gKiBjb25zdCByZXN1bHQgPSBpc1NhbWVEYXkobmV3IERhdGUoMjAxNCwgOCwgNCksIG5ldyBEYXRlKDIwMTUsIDgsIDQpKVxuICogLy89PiBmYWxzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNTYW1lRGF5KGRhdGVMZWZ0LCBkYXRlUmlnaHQpIHtcbiAgY29uc3QgZGF0ZUxlZnRTdGFydE9mRGF5ID0gc3RhcnRPZkRheShkYXRlTGVmdCk7XG4gIGNvbnN0IGRhdGVSaWdodFN0YXJ0T2ZEYXkgPSBzdGFydE9mRGF5KGRhdGVSaWdodCk7XG5cbiAgcmV0dXJuICtkYXRlTGVmdFN0YXJ0T2ZEYXkgPT09ICtkYXRlUmlnaHRTdGFydE9mRGF5O1xufVxuXG4vLyBGYWxsYmFjayBmb3IgbW9kdWxhcml6ZWQgaW1wb3J0czpcbmV4cG9ydCBkZWZhdWx0IGlzU2FtZURheTtcbiIsImltcG9ydCB7IHByb2plY3RzIH0gZnJvbSBcIi4vbWFuYWdlUHJvamVjdFwiO1xuaW1wb3J0IHsgaXNUb2RheSwgdG9EYXRlIH0gZnJvbSBcImRhdGUtZm5zXCI7XG5cbmNvbnN0IHJlbmRlclRhc2sgPSAoKCkgPT4ge1xuICAgIGZ1bmN0aW9uIGRpc3BsYXlBbGxUYXNrKGl0ZW1zLCBkaXNwbGF5KSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGFza0lkJywgYCR7aXRlbXMuaWR9YClcblxuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICAgIGNvbnN0IGR1ZWRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29uc3QgcHJpb3JpdHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgICAgICB0aXRsZS50ZXh0Q29udGVudCA9IGBUaXRsZTogJHtpdGVtcy50aXRsZX1gO1xuICAgICAgICBkdWVkYXRlLnRleHRDb250ZW50ID0gYER1ZSBEYXRlOiAke2l0ZW1zLmR1ZWRhdGV9YDtcbiAgICAgICAgZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBgRGVzY3JpcHRpb246ICR7aXRlbXMuZGVzY3JpcHRpb259YDtcbiAgICAgICAgcHJpb3JpdHkudGV4dENvbnRlbnQgPSBgUHJpb3JpdHk6ICR7aXRlbXMucHJpb3JpdHl9YDtcblxuICAgICAgICBjb250YWluZXIuYXBwZW5kKHRpdGxlLCBkdWVkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHkpO1xuICAgICAgICBkaXNwbGF5LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG5cbiAgICAgICAgcmV0dXJuIGRpc3BsYXk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlzcGxheUluYm94KCkge1xuICAgICAgICBsZXQgbGlzdCA9IHByb2plY3RzLnByb2plY3RMaXN0WzBdLnRhc2tMaXN0O1xuICAgICAgICBsZXQgaXRlbXMgPSBsaXN0W2xpc3QubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgY29uc3QgZ2VuZXJhbExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZ2VuZXJhbCcpO1xuICAgICAgICBcbiAgICAgICAgZGlzcGxheUFsbFRhc2soaXRlbXMsIGdlbmVyYWxMaXN0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNwbGF5RGFpbHkoKSB7XG4gICAgICAgIGxldCBsaXN0ID0gcHJvamVjdHMucHJvamVjdExpc3RbMF0udGFza0xpc3Q7XG4gICAgICAgIGNvbnN0IGdlbmVyYWxMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2dlbmVyYWwnKTtcblxuICAgICAgICB3aGlsZSAoZ2VuZXJhbExpc3QubGFzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgICAgICAgZ2VuZXJhbExpc3QucmVtb3ZlQ2hpbGQoZ2VuZXJhbExpc3QubGFzdEVsZW1lbnRDaGlsZCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGRhaWx5VGFza3MgPSBsaXN0LmZpbHRlcih0YXNrID0+IGlzVG9kYXkodG9EYXRlKHRhc2suZHVlZGF0ZSkpKTtcbiAgICAgICAgXG4gICAgICAgIGRhaWx5VGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgICAgIGRpc3BsYXlBbGxUYXNrKHRhc2ssIGdlbmVyYWxMaXN0KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZGlzcGxheUluYm94LCBkaXNwbGF5RGFpbHkgfVxufSkoKVxuXG5jb25zdCByZW5kZXJQcm9qZWN0ID0gKCgpID0+IHtcbiAgICBmdW5jdGlvbiBkaXNwbGF5UHJvamVjdCgpIHtcbiAgICAgICAgbGV0IGxpc3QgPSBwcm9qZWN0cy5wcm9qZWN0TGlzdDtcbiAgICAgICAgbGV0IHByb2plY3QgPSBsaXN0W2xpc3QubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgY29uc3QgcHJvamVjdERpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWxsLXByb2plY3RzJyk7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgICAgIGNvbnN0IHByb2plY3RUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBjb25zdCBwcm9qZWN0VGFza0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG4gICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0Jyk7XG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvamVjdElkJywgYCR7cHJvamVjdC5pZH1gKTtcbiAgICAgICAgcHJvamVjdFRhc2tCdG4uc2V0QXR0cmlidXRlKCdkYXRhLXByb2plY3RJZCcsIGAke3Byb2plY3QuaWR9YCk7XG4gICAgICAgIHByb2plY3RUYXNrQnRuLnNldEF0dHJpYnV0ZSgnaWQnLCBgcHJvamVjdC0ke3Byb2plY3QuaWR9YCk7XG5cbiAgICAgICAgcHJvamVjdFRpdGxlLnRleHRDb250ZW50ID0gYCR7cHJvamVjdC50aXRsZX1gO1xuICAgICAgICBwcm9qZWN0VGFza0J0bi50ZXh0Q29udGVudCA9ICcrJztcblxuICAgICAgICBwcm9qZWN0VGFza0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncHJvamVjdCBpZCcsIHByb2plY3RzLmdyYWJQcm9qZWN0SWQoZSkpO1xuICAgICAgICAgICAgY29uc3QgbmV3VGFza0Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWFpbi1mb3JtJyk7XG5cbiAgICAgICAgICAgIHByb2plY3RzLmdyYWJQcm9qZWN0SWQoZSk7XG4gICAgICAgICAgICBuZXdUYXNrRm9ybS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmQocHJvamVjdFRpdGxlLCBwcm9qZWN0VGFza0J0bik7XG4gICAgICAgIHByb2plY3REaXNwbGF5LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG5cbiAgICAgICAgcmV0dXJuIHByb2plY3REaXNwbGF5XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZGlzcGxheVByb2plY3QgfVxufSkoKVxuXG5leHBvcnQgeyByZW5kZXJUYXNrLCByZW5kZXJQcm9qZWN0IH0iLCJsZXQgZGVmYXVsdE9wdGlvbnMgPSB7fTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldERlZmF1bHRPcHRpb25zKCkge1xuICByZXR1cm4gZGVmYXVsdE9wdGlvbnM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXREZWZhdWx0T3B0aW9ucyhuZXdPcHRpb25zKSB7XG4gIGRlZmF1bHRPcHRpb25zID0gbmV3T3B0aW9ucztcbn1cbiIsImltcG9ydCB7IHRvRGF0ZSB9IGZyb20gXCIuL3RvRGF0ZS5tanNcIjtcbmltcG9ydCB7IGdldERlZmF1bHRPcHRpb25zIH0gZnJvbSBcIi4vX2xpYi9kZWZhdWx0T3B0aW9ucy5tanNcIjtcblxuLyoqXG4gKiBUaGUge0BsaW5rIHN0YXJ0T2ZXZWVrfSBmdW5jdGlvbiBvcHRpb25zLlxuICovXG5cbi8qKlxuICogQG5hbWUgc3RhcnRPZldlZWtcbiAqIEBjYXRlZ29yeSBXZWVrIEhlbHBlcnNcbiAqIEBzdW1tYXJ5IFJldHVybiB0aGUgc3RhcnQgb2YgYSB3ZWVrIGZvciB0aGUgZ2l2ZW4gZGF0ZS5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFJldHVybiB0aGUgc3RhcnQgb2YgYSB3ZWVrIGZvciB0aGUgZ2l2ZW4gZGF0ZS5cbiAqIFRoZSByZXN1bHQgd2lsbCBiZSBpbiB0aGUgbG9jYWwgdGltZXpvbmUuXG4gKlxuICogQHR5cGVQYXJhbSBEYXRlVHlwZSAtIFRoZSBgRGF0ZWAgdHlwZSwgdGhlIGZ1bmN0aW9uIG9wZXJhdGVzIG9uLiBHZXRzIGluZmVycmVkIGZyb20gcGFzc2VkIGFyZ3VtZW50cy4gQWxsb3dzIHRvIHVzZSBleHRlbnNpb25zIGxpa2UgW2BVVENEYXRlYF0oaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL3V0YykuXG4gKlxuICogQHBhcmFtIGRhdGUgLSBUaGUgb3JpZ2luYWwgZGF0ZVxuICogQHBhcmFtIG9wdGlvbnMgLSBBbiBvYmplY3Qgd2l0aCBvcHRpb25zXG4gKlxuICogQHJldHVybnMgVGhlIHN0YXJ0IG9mIGEgd2Vla1xuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBUaGUgc3RhcnQgb2YgYSB3ZWVrIGZvciAyIFNlcHRlbWJlciAyMDE0IDExOjU1OjAwOlxuICogY29uc3QgcmVzdWx0ID0gc3RhcnRPZldlZWsobmV3IERhdGUoMjAxNCwgOCwgMiwgMTEsIDU1LCAwKSlcbiAqIC8vPT4gU3VuIEF1ZyAzMSAyMDE0IDAwOjAwOjAwXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElmIHRoZSB3ZWVrIHN0YXJ0cyBvbiBNb25kYXksIHRoZSBzdGFydCBvZiB0aGUgd2VlayBmb3IgMiBTZXB0ZW1iZXIgMjAxNCAxMTo1NTowMDpcbiAqIGNvbnN0IHJlc3VsdCA9IHN0YXJ0T2ZXZWVrKG5ldyBEYXRlKDIwMTQsIDgsIDIsIDExLCA1NSwgMCksIHsgd2Vla1N0YXJ0c09uOiAxIH0pXG4gKiAvLz0+IE1vbiBTZXAgMDEgMjAxNCAwMDowMDowMFxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRPZldlZWsoZGF0ZSwgb3B0aW9ucykge1xuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IGdldERlZmF1bHRPcHRpb25zKCk7XG4gIGNvbnN0IHdlZWtTdGFydHNPbiA9XG4gICAgb3B0aW9ucz8ud2Vla1N0YXJ0c09uID8/XG4gICAgb3B0aW9ucz8ubG9jYWxlPy5vcHRpb25zPy53ZWVrU3RhcnRzT24gPz9cbiAgICBkZWZhdWx0T3B0aW9ucy53ZWVrU3RhcnRzT24gPz9cbiAgICBkZWZhdWx0T3B0aW9ucy5sb2NhbGU/Lm9wdGlvbnM/LndlZWtTdGFydHNPbiA/P1xuICAgIDA7XG5cbiAgY29uc3QgX2RhdGUgPSB0b0RhdGUoZGF0ZSk7XG4gIGNvbnN0IGRheSA9IF9kYXRlLmdldERheSgpO1xuICBjb25zdCBkaWZmID0gKGRheSA8IHdlZWtTdGFydHNPbiA/IDcgOiAwKSArIGRheSAtIHdlZWtTdGFydHNPbjtcblxuICBfZGF0ZS5zZXREYXRlKF9kYXRlLmdldERhdGUoKSAtIGRpZmYpO1xuICBfZGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgcmV0dXJuIF9kYXRlO1xufVxuXG4vLyBGYWxsYmFjayBmb3IgbW9kdWxhcml6ZWQgaW1wb3J0czpcbmV4cG9ydCBkZWZhdWx0IHN0YXJ0T2ZXZWVrO1xuIiwiaW1wb3J0IHsgaXNTYW1lV2VlayB9IGZyb20gXCIuL2lzU2FtZVdlZWsubWpzXCI7XG5cbi8qKlxuICogVGhlIHtAbGluayBpc1RoaXNXZWVrfSBmdW5jdGlvbiBvcHRpb25zLlxuICovXG5cbi8qKlxuICogQG5hbWUgaXNUaGlzV2Vla1xuICogQGNhdGVnb3J5IFdlZWsgSGVscGVyc1xuICogQHN1bW1hcnkgSXMgdGhlIGdpdmVuIGRhdGUgaW4gdGhlIHNhbWUgd2VlayBhcyB0aGUgY3VycmVudCBkYXRlP1xuICogQHB1cmUgZmFsc2VcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIElzIHRoZSBnaXZlbiBkYXRlIGluIHRoZSBzYW1lIHdlZWsgYXMgdGhlIGN1cnJlbnQgZGF0ZT9cbiAqXG4gKiBAdHlwZVBhcmFtIERhdGVUeXBlIC0gVGhlIGBEYXRlYCB0eXBlLCB0aGUgZnVuY3Rpb24gb3BlcmF0ZXMgb24uIEdldHMgaW5mZXJyZWQgZnJvbSBwYXNzZWQgYXJndW1lbnRzLiBBbGxvd3MgdG8gdXNlIGV4dGVuc2lvbnMgbGlrZSBbYFVUQ0RhdGVgXShodHRwczovL2dpdGh1Yi5jb20vZGF0ZS1mbnMvdXRjKS5cbiAqXG4gKiBAcGFyYW0gZGF0ZSAtIFRoZSBkYXRlIHRvIGNoZWNrXG4gKiBAcGFyYW0gb3B0aW9ucyAtIFRoZSBvYmplY3Qgd2l0aCBvcHRpb25zXG4gKlxuICogQHJldHVybnMgVGhlIGRhdGUgaXMgaW4gdGhpcyB3ZWVrXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElmIHRvZGF5IGlzIDI1IFNlcHRlbWJlciAyMDE0LCBpcyAyMSBTZXB0ZW1iZXIgMjAxNCBpbiB0aGlzIHdlZWs/XG4gKiBjb25zdCByZXN1bHQgPSBpc1RoaXNXZWVrKG5ldyBEYXRlKDIwMTQsIDgsIDIxKSlcbiAqIC8vPT4gdHJ1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJZiB0b2RheSBpcyAyNSBTZXB0ZW1iZXIgMjAxNCBhbmQgd2VlayBzdGFydHMgd2l0aCBNb25kYXlcbiAqIC8vIGlzIDIxIFNlcHRlbWJlciAyMDE0IGluIHRoaXMgd2Vlaz9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzVGhpc1dlZWsobmV3IERhdGUoMjAxNCwgOCwgMjEpLCB7IHdlZWtTdGFydHNPbjogMSB9KVxuICogLy89PiBmYWxzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNUaGlzV2VlayhkYXRlLCBvcHRpb25zKSB7XG4gIHJldHVybiBpc1NhbWVXZWVrKGRhdGUsIERhdGUubm93KCksIG9wdGlvbnMpO1xufVxuXG4vLyBGYWxsYmFjayBmb3IgbW9kdWxhcml6ZWQgaW1wb3J0czpcbmV4cG9ydCBkZWZhdWx0IGlzVGhpc1dlZWs7XG4iLCJpbXBvcnQgeyBzdGFydE9mV2VlayB9IGZyb20gXCIuL3N0YXJ0T2ZXZWVrLm1qc1wiO1xuXG4vKipcbiAqIFRoZSB7QGxpbmsgaXNTYW1lV2Vla30gZnVuY3Rpb24gb3B0aW9ucy5cbiAqL1xuXG4vKipcbiAqIEBuYW1lIGlzU2FtZVdlZWtcbiAqIEBjYXRlZ29yeSBXZWVrIEhlbHBlcnNcbiAqIEBzdW1tYXJ5IEFyZSB0aGUgZ2l2ZW4gZGF0ZXMgaW4gdGhlIHNhbWUgd2VlayAoYW5kIG1vbnRoIGFuZCB5ZWFyKT9cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIEFyZSB0aGUgZ2l2ZW4gZGF0ZXMgaW4gdGhlIHNhbWUgd2VlayAoYW5kIG1vbnRoIGFuZCB5ZWFyKT9cbiAqXG4gKiBAdHlwZVBhcmFtIERhdGVUeXBlIC0gVGhlIGBEYXRlYCB0eXBlLCB0aGUgZnVuY3Rpb24gb3BlcmF0ZXMgb24uIEdldHMgaW5mZXJyZWQgZnJvbSBwYXNzZWQgYXJndW1lbnRzLiBBbGxvd3MgdG8gdXNlIGV4dGVuc2lvbnMgbGlrZSBbYFVUQ0RhdGVgXShodHRwczovL2dpdGh1Yi5jb20vZGF0ZS1mbnMvdXRjKS5cbiAqXG4gKiBAcGFyYW0gZGF0ZUxlZnQgLSBUaGUgZmlyc3QgZGF0ZSB0byBjaGVja1xuICogQHBhcmFtIGRhdGVSaWdodCAtIFRoZSBzZWNvbmQgZGF0ZSB0byBjaGVja1xuICogQHBhcmFtIG9wdGlvbnMgLSBBbiBvYmplY3Qgd2l0aCBvcHRpb25zXG4gKlxuICogQHJldHVybnMgVGhlIGRhdGVzIGFyZSBpbiB0aGUgc2FtZSB3ZWVrIChhbmQgbW9udGggYW5kIHllYXIpXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIEFyZSAzMSBBdWd1c3QgMjAxNCBhbmQgNCBTZXB0ZW1iZXIgMjAxNCBpbiB0aGUgc2FtZSB3ZWVrP1xuICogY29uc3QgcmVzdWx0ID0gaXNTYW1lV2VlayhuZXcgRGF0ZSgyMDE0LCA3LCAzMSksIG5ldyBEYXRlKDIwMTQsIDgsIDQpKVxuICogLy89PiB0cnVlXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElmIHdlZWsgc3RhcnRzIHdpdGggTW9uZGF5LFxuICogLy8gYXJlIDMxIEF1Z3VzdCAyMDE0IGFuZCA0IFNlcHRlbWJlciAyMDE0IGluIHRoZSBzYW1lIHdlZWs/XG4gKiBjb25zdCByZXN1bHQgPSBpc1NhbWVXZWVrKG5ldyBEYXRlKDIwMTQsIDcsIDMxKSwgbmV3IERhdGUoMjAxNCwgOCwgNCksIHtcbiAqICAgd2Vla1N0YXJ0c09uOiAxXG4gKiB9KVxuICogLy89PiBmYWxzZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBcmUgMSBKYW51YXJ5IDIwMTQgYW5kIDEgSmFudWFyeSAyMDE1IGluIHRoZSBzYW1lIHdlZWs/XG4gKiBjb25zdCByZXN1bHQgPSBpc1NhbWVXZWVrKG5ldyBEYXRlKDIwMTQsIDAsIDEpLCBuZXcgRGF0ZSgyMDE1LCAwLCAxKSlcbiAqIC8vPT4gZmFsc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzU2FtZVdlZWsoZGF0ZUxlZnQsIGRhdGVSaWdodCwgb3B0aW9ucykge1xuICBjb25zdCBkYXRlTGVmdFN0YXJ0T2ZXZWVrID0gc3RhcnRPZldlZWsoZGF0ZUxlZnQsIG9wdGlvbnMpO1xuICBjb25zdCBkYXRlUmlnaHRTdGFydE9mV2VlayA9IHN0YXJ0T2ZXZWVrKGRhdGVSaWdodCwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuICtkYXRlTGVmdFN0YXJ0T2ZXZWVrID09PSArZGF0ZVJpZ2h0U3RhcnRPZldlZWs7XG59XG5cbi8vIEZhbGxiYWNrIGZvciBtb2R1bGFyaXplZCBpbXBvcnRzOlxuZXhwb3J0IGRlZmF1bHQgaXNTYW1lV2VlaztcbiIsImltcG9ydCB7IEFkZHRvTGlzdCB9IGZyb20gXCIuL21hbmFnZUxpc3RcIjtcbmltcG9ydCB7IHJlbmRlclRhc2sgfSBmcm9tIFwiLi9VSVwiO1xuaW1wb3J0IHsgcHJvamVjdHMgfSBmcm9tIFwiLi9tYW5hZ2VQcm9qZWN0XCI7XG5pbXBvcnQgeyB0b0RhdGUsIGlzVGhpc1dlZWssIGlzVG9kYXkgfSBmcm9tIFwiZGF0ZS1mbnNcIjtcblxuXG5jb25zdCBjcmVhdGVUYXNrID0gKGlkLCB0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZWRhdGUsIHByaW9yaXR5LCBwcm9qZWN0KSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQsIHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlZGF0ZSwgcHJpb3JpdHksIHByb2plY3RcbiAgICB9XG59XG5cbmNvbnN0IE5ld1Rhc2sgPSAoKCkgPT4ge1xuXG4gICAgbGV0IHRpdGxlO1xuICAgIGxldCBkZXNjcmlwdGlvbjtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZU5ld1Rhc2soKSB7XG4gICAgICAgIGNvbnN0IHByb2plY3RMaXN0ID0gcHJvamVjdHMuZ3JhYlByb2plY3RMaXN0KCk7XG5cbiAgICAgICAgdGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGl0bGUnKS52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVzY3JpcHRpb24nKS52YWx1ZTtcblxuICAgICAgICBsZXQgZHVlZGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlJykudmFsdWU7XG4gICAgICAgIGxldCBwcmlvcml0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmlvcml0eScpLnZhbHVlO1xuICAgICAgICBsZXQgaWQgPSBjcmVhdGVJZCgpO1xuICAgICAgICBsZXQgcHJvamVjdElkID0gcHJvamVjdHMuZ3JhYkN1cnJlbnRQcm9qZWN0KCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coaXNUaGlzV2Vlayh0b0RhdGUoZHVlZGF0ZSkpKVxuICAgICAgICBjb25zb2xlLmxvZyhpc1RvZGF5KHRvRGF0ZShkdWVkYXRlKSkpXG5cbiAgICAgICAgaWYgKHRpdGxlID09PSAnJyB8fFxuICAgICAgICAgICAgZGVzY3JpcHRpb24gPT09ICcnIHx8XG4gICAgICAgICAgICBkdWVkYXRlID09PSAnJykgcmV0dXJuXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdGFzayA9IGNyZWF0ZVRhc2soaWQsIHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlZGF0ZSwgcHJpb3JpdHksIHByb2plY3RJZCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0YXNrKTtcblxuICAgICAgICAgICAgaWYgKHByb2plY3RJZCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHByb2plY3RMaXN0WzBdLnRhc2tMaXN0LnB1c2godGFzayk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocHJvamVjdExpc3QpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcHJvamVjdExpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAocHJvamVjdExpc3RbaV0uaWQgPT09IHByb2plY3RJZCkge1xuICAgICAgICAgICAgICAgICAgICBBZGR0b0xpc3QuYWRkVG9MaXN0KHRhc2spO1xuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0TGlzdFtpXS50YXNrTGlzdC5wdXNoKHRhc2spO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0TGlzdClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlSWQoKSB7XG4gICAgICAgIGxldCBsaXN0ID0gQWRkdG9MaXN0LlRvZG9MaXN0O1xuICAgICAgICBsZXQgaWQ7XG5cbiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gaWQgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGlkID0gbGlzdFtsaXN0Lmxlbmd0aC0xXS5pZCArIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgbGV0IHRpdGxlVmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGl0bGUnKTtcbiAgICAgICAgdGl0bGVWYWx1ZS52YWx1ZSA9ICcnO1xuICAgICAgICB0aXRsZSA9ICcnO1xuXG4gICAgICAgIGxldCBkZXNjcmlwdGlvblZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2NyaXB0aW9uJyk7XG4gICAgICAgIGRlc2NyaXB0aW9uVmFsdWUudmFsdWUgPSAnJztcbiAgICAgICAgZGVzY3JpcHRpb24gPSAnJztcblxuICAgICAgICBsZXQgZHVlZGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlJyk7XG4gICAgICAgIGR1ZWRhdGUudmFsdWUgPSAnJztcblxuICAgICAgICBsZXQgcHJpb3JpdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpb3JpdHknKTtcbiAgICAgICAgcHJpb3JpdHkudmFsdWUgPSAnTG93JztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0U3VibWl0QnRuKCkge1xuICAgICAgICBjb25zdCBzdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3VibWl0Jyk7XG5cbiAgICAgICAgc3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIHN1Ym1pdFRhc2soKTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFRhc2soKSB7XG4gICAgICAgIGNvbnN0IG5ld1Rhc2tGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21haW4tZm9ybScpO1xuICAgICAgICBjb25zdCBuZXdUYXNrQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ld1Rhc2snKTtcbiAgICAgICAgXG4gICAgICAgIGNyZWF0ZU5ld1Rhc2soKTtcblxuICAgICAgICBpZiAodGl0bGUgPT09ICcnIHx8IGRlc2NyaXB0aW9uID09PSAnJykgcmV0dXJuXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVuZGVyVGFzay5kaXNwbGF5SW5ib3goKTtcbiAgICAgICAgICAgIHJlc2V0KCk7XG4gICAgICAgICAgICBuZXdUYXNrRm9ybS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgICAgICAgIG5ld1Rhc2tCdG4ucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbmNlbFRhc2soKSB7XG4gICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYW5jZWwnKTtcbiAgICAgICAgY29uc3QgbmV3VGFza0Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWFpbi1mb3JtJyk7XG4gICAgICAgIGNvbnN0IG5ld1Rhc2tCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmV3VGFzaycpO1xuXG4gICAgICAgIGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICByZXNldCgpO1xuICAgICAgICAgICAgbmV3VGFza0Zvcm0uc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAnJyk7XG4gICAgICAgICAgICBuZXdUYXNrQnRuLnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb3BlblRhc2tDcmVhdG9yKCkge1xuICAgICAgICBjb25zdCBuZXdUYXNrQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ld1Rhc2snKTtcbiAgICAgICAgY29uc3QgbmV3VGFza0Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWFpbi1mb3JtJyk7XG5cbiAgICAgICAgbmV3VGFza0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBwcm9qZWN0cy5ncmFiUHJvamVjdElkKGUpO1xuICAgICAgICAgICAgbmV3VGFza0Zvcm0ucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIG5ld1Rhc2tCdG4uc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAnJyk7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIHsgY3JlYXRlTmV3VGFzaywgaW5pdFN1Ym1pdEJ0biwgY2FuY2VsVGFzaywgb3BlblRhc2tDcmVhdG9yIH1cbn0pKCk7XG5cbmV4cG9ydCB7IE5ld1Rhc2sgfVxuIiwiaW1wb3J0IHsgTmV3VGFzayB9IGZyb20gXCIuL21hbmFnZVRhc2suanNcIjtcbmltcG9ydCB7IHByb2plY3RzIH0gZnJvbSBcIi4vbWFuYWdlUHJvamVjdC5qc1wiO1xuaW1wb3J0IHsgcmVuZGVyVGFzayB9IGZyb20gXCIuL1VJLmpzXCI7XG5cbk5ld1Rhc2suaW5pdFN1Ym1pdEJ0bigpO1xuTmV3VGFzay5jYW5jZWxUYXNrKCk7XG5OZXdUYXNrLm9wZW5UYXNrQ3JlYXRvcigpO1xuXG5wcm9qZWN0cy5zdWJtaXRQcm9qZWN0KCk7XG5cbmNvbnN0IHRvZGF5VGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RvZGF5Jyk7XG5cbnRvZGF5VGFiLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHJlbmRlclRhc2suZGlzcGxheURhaWx5KCk7XG59KSJdLCJuYW1lcyI6WyJBZGR0b0xpc3QiLCJUb2RvTGlzdCIsImFkZFRvTGlzdCIsInRhc2siLCJwdXNoIiwiY29uc29sZSIsImxvZyIsIm5ld1Byb2plY3QiLCJ0aXRsZSIsInRhc2tMaXN0IiwiaWQiLCJwcm9qZWN0cyIsInByb2plY3RUaXRsZSIsInByb2plY3RMaXN0IiwiZ2VuZXJhbExpc3QiLCJjdXJyZW50UHJvamVjdCIsInN1Ym1pdFByb2plY3QiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJwcm9qZWN0SWQiLCJsZW5ndGgiLCJwcm9qZWN0IiwiYWRkVG9Qcm9qZWN0TGlzdCIsImNyZWF0ZVByb2plY3QiLCJyZW5kZXJQcm9qZWN0IiwiZGlzcGxheVByb2plY3QiLCJncmFiUHJvamVjdElkIiwicGFyc2VJbnQiLCJ0YXJnZXQiLCJnZXRBdHRyaWJ1dGUiLCJncmFiQ3VycmVudFByb2plY3QiLCJncmFiUHJvamVjdExpc3QiLCJ0b0RhdGUiLCJhcmd1bWVudCIsImFyZ1N0ciIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiY2FsbCIsIkRhdGUiLCJjb25zdHJ1Y3RvciIsIk5hTiIsInN0YXJ0T2ZEYXkiLCJkYXRlIiwiX2RhdGUiLCJzZXRIb3VycyIsImlzVG9kYXkiLCJkYXRlTGVmdCIsImRhdGVSaWdodCIsIm5vdyIsInJlbmRlclRhc2siLCJkaXNwbGF5QWxsVGFzayIsIml0ZW1zIiwiZGlzcGxheSIsImNvbnRhaW5lciIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJkdWVkYXRlIiwiZGVzY3JpcHRpb24iLCJwcmlvcml0eSIsInRleHRDb250ZW50IiwiYXBwZW5kIiwiYXBwZW5kQ2hpbGQiLCJkaXNwbGF5SW5ib3giLCJsaXN0IiwiZGlzcGxheURhaWx5IiwibGFzdEVsZW1lbnRDaGlsZCIsInJlbW92ZUNoaWxkIiwiZmlsdGVyIiwiZm9yRWFjaCIsInByb2plY3REaXNwbGF5IiwicHJvamVjdFRhc2tCdG4iLCJjbGFzc0xpc3QiLCJhZGQiLCJuZXdUYXNrRm9ybSIsInJlbW92ZUF0dHJpYnV0ZSIsImRlZmF1bHRPcHRpb25zIiwiZ2V0RGVmYXVsdE9wdGlvbnMiLCJzdGFydE9mV2VlayIsIm9wdGlvbnMiLCJ3ZWVrU3RhcnRzT24iLCJsb2NhbGUiLCJkYXkiLCJnZXREYXkiLCJkaWZmIiwic2V0RGF0ZSIsImdldERhdGUiLCJpc1RoaXNXZWVrIiwiaXNTYW1lV2VlayIsIk5ld1Rhc2siLCJjcmVhdGVOZXdUYXNrIiwiZ2V0RWxlbWVudEJ5SWQiLCJjcmVhdGVJZCIsImNyZWF0ZVRhc2siLCJpIiwicmVzZXQiLCJpbml0U3VibWl0QnRuIiwibmV3VGFza0J0biIsInN1Ym1pdFRhc2siLCJjYW5jZWxUYXNrIiwiY2FuY2VsQnRuIiwib3BlblRhc2tDcmVhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==